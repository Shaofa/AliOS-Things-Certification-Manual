AliOS Things测试规范

| 文档号： | xxx                                                                          |                                       |        |
|----------|------------------------------------------------------------------------------|---------------------------------------|--------|
| 日期：   | 2017年12月7日                                                                |                                       |        |
| 摘要：   | AliOS Things测试规范，包含AliOS Things Kernel、组件、通道、OTA、安全测试规范 |                                       |        |
| 关键字： | AliOS Things、功能测试、稳定性测试                                           |                                       |        |
| 版本     | 日期                                                                         | 修改内容                              | 修改人 |
| 1.0      | 2017.12.07                                                                   | 起草                                  | 少舒   |
| 1.1      | 2017.12.10                                                                   | 添加安全部分                          | 双眉   |
| 1.2      | 2017.12.18                                                                   | 增加Alink用例，用例编号AOS-3-13/14/15 | 少舒   |

目 录
=====

目 录 I

前 言 VII

摘 要 VIII

1. AliOS Things Kernel测试 1

>   1.1. 内存管理 1

>   1.1.1 动态内存分配与释放 1

>   1.1.2 动态内存分配与释放并初始化为0 1

>   1.1.3 动态扩大分配的堆内存 2

>   1.1.4 动态减小分配的堆内存 2

>   1.1.5 大内存动态分配与释放 3

>   1.2. 任务管理 3

>   1.2.1 创建与销毁任务 3

>   1.2.2 创建与销毁任务(ext) 4

>   1.2.3 创建任务key 4

>   1.2.4 删除任务key 4

>   1.2.5 设置/获取任务值 5

>   1.2.6 创建大量任务 5

>   1.2.7 反复创建/销毁任务 6

>   1.3. 多任务通信 6

>   1.3.1 互斥锁创建与销毁 6

>   1.3.2 使用互斥锁任务同步 7

>   1.3.3 信号量创建与销毁 8

>   1.3.4 使用信号量任务同步 8

>   1.3.5 队列创建与销毁 9

>   1.3.6 使用队列任务同步 9

>   1.4. 定时器 10

>   1.4.1 定时器创建与销毁 10

>   1.4.2 定时器周期修改 10

2. AliOS Things 组件测试 12

>   2.1. KV 12

>   2.1.1 读写KV 12

>   2.1.2 删除KV 12

>   2.1.3 读写删稳定性 13

>   2.2. Yloop 13

>   2.2.1 事件注册与注销 13

>   2.2.2 定时任务注册/取消 14

>   2.2.3 自定义事件循环 14

>   2.2.4 事件循环运行与停止 15

>   2.2.5 触发大量事件 15

>   2.2.6 自定义大量事件循环 15

>   2.3. uMesh 16

>   2.3.1 Help指令 16

>   2.3.2 Status查看 17

>   2.3.3 Neighbor发现功能 17

>   2.3.4 不同mesh网络间Neighbor信息隔离 17

>   2.3.5 同一个mesh网络meshnetid和meshnetsize一致性 18

>   2.3.6 查看IP地址 18

>   2.3.7 Leader连AP，其它节点不连AP组网 19

>   2.3.8 Fixed模式—leader和router 19

>   2.3.9 Fixed模式—ping IP地址 20

>   2.3.10 Fixed模式—ping UEID地址 20

>   2.3.11 Fixed模式—多字节ping IP地址 21

>   2.3.12 Fixed模式—多字节ping UEID地址 21

>   2.3.13 Fixed模式—ping多字节的极限值测试 22

>   2.3.14 Fixed模式—全网发送广播包（多播） 22

>   2.3.15 Fixed模式—router节点回收 23

>   2.3.16 Fixed模式—Router节点stop再start后的角色变化 23

>   2.3.17 Fixed模式—Leader节点stop后再start的角色变化(Leader连AP) 24

>   2.3.18 Fixed模式—Leader节点stop后再start的角色变化(Leader未连AP) 24

>   2.3.19 改变AP的channel，所有设备仍然在同一个mesh网络中 25

>   2.3.20 Mesh网中的两个节点都连AP后拓扑结构的变化 25

>   2.3.21 两个mesh网络-设备的距离与网络合并无关联性 26

>   2.3.22 两个mesh网络-不同mesh网络的设备之间无法ping通 26

>   2.3.23 两个mesh网络-AP断电不会影响其他mesh环境 26

>   2.3.24 距离测试—设备之间超出AP覆盖范围会各自成为leader 27

>   2.3.25 距离测试—相隔10米的设备之间能进行通信 27

>   2.3.26 白名单—新增设备设置白名单后，会挂在白名单列表的设备下 28

>   2.3.27 白名单—白名单为空时enable白名单会消息闭塞 28

>   2.3.28 白名单—白名单不为空时enable白名单会收到消息 29

>   2.3.29 白名单—将leader加入白名单后可侦听到广播 29

>   2.3.30 白名单—关闭白名单功能拓扑结构会相应改变 30

>   2.3.31 802.15.4组网—mac查看 30

>   2.3.32 802.15.4组网—功能测试 31

>   2.3.33 AP断网—mesh网络中AP断网不会影响网络 32

>   2.3.34 AP断电—路由器AP断电后5分钟内上电mesh网络正常 32

>   2.3.35 路由器级联拓扑—断开级联路由器电源后mesh网络存在并能进行通信 33

>   2.3.36 WDS环境—断开副路由器电源后mesh网络存在并能进行通信 33

>   2.3.37 Alink_umesh gateway服务 34

>   2.3.38 性能测试—低频指令压测（2pps） 34

>   2.3.39 长时间测试—节点间长时间ping仍能通信 35

>   2.3.40 长时间测试—AP连续断电上电一晚上后mesh网络存在 35

>   2.3.41 长时间测试—AP长时间断电再上电后mesh网络存在 36

>   2.3.42 长时间测试—AP连续断网再连网一晚上后mesh网络存在 36

>   2.3.43 长时间测试—AP长时间断网再连网后mesh网络存在 37

>   2.3.44 稳定性测试—5\*24小时长时间挂机测试 37

>   2.3.45 复杂组网—各节点间能相互ping通 37

>   2.3.46 复杂组网—各节点间能相互ping长字节 38

>   2.3.47 复杂组网—ping全网广播 38

>   2.3.48 复杂组网—AP断网再联网，mesh网络保持不变 39

>   2.3.49 复杂组网—AP断电再上电，mesh网络保持不变 39

>   2.3.50 复杂组网—12H长时间AP断网后再联网，mesh网络保持不变 40

>   2.3.51 复杂组网—12H长时间AP断电后再上电，mesh网络保持不变 40

3. AliOS Things 通道测试 42

>   3.1. Alink 42

>   3.1.1 设备注册与登录 42

>   3.1.2 设备UUID持久化 42

>   3.1.3 设备响应下行命令及上报状态 43

>   3.1.4 设备主动上报状态 43

>   3.1.5 设备恢复出厂设置 43

>   3.1.6 设备透传 44

>   3.1.7 设备上报状态时延 44

>   3.1.8 低频指令测试 45

>   3.1.9 高频指令测试 45

>   3.1.10 长时间稳定工作 45

>   3.1.11 长时间断网后恢复连接能力 46

>   3.1.12 长时间断网后恢复业务能力 46

>   3.1.13 支持无缝切换AP能力 47

>   3.1.14 超长数据包接收处理能力 47

>   3.1.15 设备上电到联网成功时长 47

>   3.2. MQTT 48

>   3.2.1 设备认证 48

>   3.2.2 MQTT通道连接 48

>   3.2.3 设备订阅topic 49

>   3.2.4 设备发布topic 49

>   3.2.5 设备取消订阅topic 49

>   3.2.6 设备心跳 50

>   3.2.7 设备反复认证与连接 50

>   3.2.8 QoS1低频消息测试 51

>   3.2.9 QoS1高频消息测试 51

>   3.2.10 长时间稳定通信 52

>   3.2.11 大数据包稳定通信 52

>   3.2.12 断网发现与重连 52

>   3.3. CoAP 53

>   3.3.1 设备认证 53

>   3.3.2 设备消息上行 53

>   3.3.3 设备反复认证 54

>   3.3.4 低频CON消息 54

>   3.3.5 长时间稳定通信 55

>   3.3.6 大数据包稳定通信 55

>   3.4. 设备配网业务 56

>   3.4.1 一键配网模式 56

>   3.4.2 一键配网模时间与成功率 56

>   3.4.3 设备联网-手机热点配网模式 57

>   3.4.4 手机热点配网时间和成功率 57

>   3.4.5 零配发现模式 58

>   3.4.6 零配发现联网时间与成功率 58

>   3.4.7 更改上行 AP配置重新联网 59

>   3.4.8 智能路由器联网 59

>   3.4.9 DHCP获取 IP耗时 60

>   3.4.10 DHCP 获取 IP 成功率 60

>   3.4.11 DHCP 失败重试间隔 61

>   3.4.12 联网Log 查看支持 61

>   3.4.13 无线功能特性兼容性 62

>   3.4.14 主流 AP 兼容性 62

>   3.4.15 主流手机兼容性 63

>   3.4.16 主流手机操作系统兼容性 63

4. AliOS Things FOTA测试 64

>   4.1. FOTA 64

>   4.1.1 设备正常升级流程 64

>   4.1.2 下载固件被中断 64

>   4.1.3 升级过程关闭电源 65

>   4.1.4 设备反复升级稳定性 65

5. AliOS Things 安全测试 66

>   5.1. TLS 66

>   5.1.1 设备数据通信使用TLS 66

>   5.2. ID2 66

>   5.2.1 设备硬件安全能力 66

>   5.2.2 使用ID2完成设备认证（挑战字方式） 67

>   5.2.3 使用ID2完成设备认证（时间戳方式） 67

>   5.2.4 使用ID2从服务端获取关键数据（挑战字方式） 68

>   5.2.5 使用ID2从服务端获取关键数据（时间戳方式） 68

>   5.3. 秘钥安全存储 69

>   5.3.1 设备应用key安全存储及安全使用 69

>   5.4. 安全启动 70

>   5.4.1 设备安全启动 70

附 录 71

>   附录 A 测试拓扑图 71

>   附录 B 复杂组网拓扑图 72

>   附录 C Alink 协议版本说明 73

>   附录 D mesh测试设备与AP相对位置示意图 74

前 言
=====

本标准按照GB/T 1.1-2009给出的规则起草。

本标准发布范围为IoT合作伙伴计划内的相关合作伙伴厂商，未经同意和许可，请勿转发。

本标准起草部门：

本标准主要起草人：

本标准评审人：

本标准于XXXX年XX月首次发布，本次为首次发布。

摘 要
=====

>   AliOS Things 是 AliOS 家族旗下的、面向 IoT
>   领域的、轻量级物联网嵌入式操作系统。 AliOS Things 将致力于搭建云端一体化 IoT
>   基础设施，具备极致性能、极简开发、云端一体、丰富组件、安全防护等关键能力，并支持终端设备连接到阿里云
>   Link，可广泛应用在智能家居、智慧城市、新出行等领域。为了保证移植AliOS
>   Things后芯片稳定工作，本文件规范了AliOS
>   Things功能测试和稳定性测试要求，主要包括了AliOS Things Kernel测试规范、AliOS
>   Things组件测试规范、AliOS Things通道测试规范和AliOS Things
>   FOTA测试范四部分。

>   **关键字：**IoT，AliOS Things，功能测试，稳定性测试

AliOS Things Kernel测试
=======================

内存管理
--------

### 动态内存分配与释放

| 测试用例编号 | AOS-1-1                                         |
|--------------|-------------------------------------------------|
| 测试用例     | 动态内存分配与释放                              |
| 测试目的     | 验证aos_malloc/aos_free能否正常分配与释放堆内存 |
| 测试属性     | 必选 \| P0 \| 功能用例                          |
| 测试设备     | 1.设备，2.串口线，3.PC                          |
| 测试拓扑结构 | 一个设备串口连接PC                              |
| 测试预置条件 | 设备上电开机后有空闲的RAM空间                   |
| 测试步骤     | 调用aos_malloc分配堆内存 512字节                |
| 预期结果     | 分配和释放堆内存成功                            |
| 备注         |                                                 |

1.  读写该512字节堆内存

2.  调用aos_free释放该512字节内存

3.  读写分配的堆内存成功

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 动态内存分配与释放并初始化为0

| 测试用例编号 | AOS-1-2                                                       |
|--------------|---------------------------------------------------------------|
| 测试用例     | 动态内存分配与释放并初始化为0                                 |
| 测试目的     | 验证aos_zalloc能否正常分配与释放堆内存并将分配的内存初始化为0 |
| 测试属性     | 必选 \| P0 \| 功能用例                                        |
| 测试设备     | 1.设备，2.串口线，3.PC                                        |
| 测试拓扑结构 | 一个设备串口连接PC                                            |
| 测试预置条件 | 设备上电开机后空闲RAM空间 \> 512 Bytes                        |
| 测试步骤     | 调用aos_zalloc分配堆内存512 Bytes                             |
| 预期结果     | 分配和释放堆内存成功                                          |
| 备注         |                                                               |

1.  读该512 Bytes堆内存，判断是否为0

2.  调用aos_free释放该内存

3.  分配的512 Bytes内存被初始化为0

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 动态扩大分配的堆内存

| 测试用例编号 | AOS-1-3                                        |
|--------------|------------------------------------------------|
| 测试用例     | 动态扩大分配的堆内存                           |
| 测试目的     | 验证aos_realloc能否正常扩大堆内存大小          |
| 测试属性     | 必选 \| P0 \| 功能用例                         |
| 测试设备     | 1.设备，2.串口线，3.PC                         |
| 测试拓扑结构 | 一个设备串口连接PC                             |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes      |
| 测试步骤     | 调用aos_malloc分配堆内存512 Bytes，起始地址为A |
| 预期结果     | 分配和释放堆内存成功                           |
| 备注         |                                                |

1.  将512 Bytes写为0x5A

2.  调用aos_realloc将起始地址为A的512 Bytes内存块扩大为1024 Bytes

3.  读A地址开始的512 Bytes，与0x5A比较

4.  读写A+512地址开始的512 Bytes内存

5.  调用aos_free释放该内存

6.  步骤4读出的512 Bytes全部为0x5A

7.  步骤5读写扩大的512 Bytes成功

8.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 动态减小分配的堆内存

| 测试用例编号 | AOS-1-4                                        |
|--------------|------------------------------------------------|
| 测试用例     | 动态减小分配的堆内存                           |
| 测试目的     | 验证aos_realloc能否正常减小堆内存大小          |
| 测试属性     | 必选 \| P0 \| 功能用例                         |
| 测试设备     | 1.设备，2.串口线，3.PC                         |
| 测试拓扑结构 | 一个设备串口连接PC                             |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 512 Bytes       |
| 测试步骤     | 调用aos_malloc分配堆内存512 Bytes，起始地址为A |
| 预期结果     | 分配和释放堆内存成功                           |
| 备注         |                                                |

1.  将512 Bytes写为0x5A

2.  调用aos_realloc将起始地址为A的512 Bytes内存块减小为256 Bytes

3.  读A地址开始的256 Bytes，与0x5A比较

4.  调用aos_free释放该内存

5.  步骤4读出的256 Bytes全部为0x5A

6.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 大内存动态分配与释放

| 测试用例编号 | AOS-1-5                                          |
|--------------|--------------------------------------------------|
| 测试用例     | 大内存动态分配与释放                             |
| 测试目的     | 验证AliOS Things在大内存反复分配与释放时稳定工作 |
| 测试属性     | 必选 \| P0 \| 稳定性用例                         |
| 测试设备     | 1.设备，2.串口线，3.PC                           |
| 测试拓扑结构 | 一个设备串口连接PC                               |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes        |
| 测试步骤     | 调用aos_malloc分配堆内存1024 Bytes，起始地址为A  |
| 预期结果     | 10W次分配和释放堆内存成功率≥99.9%                |
| 备注         |                                                  |

1.  起始地址为A的1024字节初始化为0x000\~0x3FF

2.  调用aos_free释放起始地址为A的1024字节内存

3.  步骤1\~3重复10W次

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

任务管理
--------

### 创建与销毁任务

| 测试用例编号 | AOS-1-6                                                  |
|--------------|----------------------------------------------------------|
| 测试用例     | 创建与销毁任务                                           |
| 测试目的     | 验证aos_task_new正确创建任务                             |
| 测试属性     | 必选\| P0 \| 功能用例                                    |
| 测试设备     | 1.设备，2.串口线，3.PC                                   |
| 测试拓扑结构 | 一个设备串口连接PC                                       |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                |
| 测试步骤     | 调用aos_task_new创建任务，指定任务函数，栈空间大小为1024 |
| 预期结果     | 串口正确打印出任务名称                                   |
| 备注         |                                                          |

1.  任务函数中调用aos_task_name获取任务名称并打印10次

2.  调用aos_task_exit退出任务

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 创建与销毁任务(ext)

| 测试用例编号 | AOS-1-7                                                      |
|--------------|--------------------------------------------------------------|
| 测试用例     | 创建与销毁任务(ext)                                          |
| 测试目的     | 验证aos_task_new_ext正确创建任务                             |
| 测试属性     | 必选\| P0 \| 功能用例                                        |
| 测试设备     | 1.设备，2.串口线，3.PC                                       |
| 测试拓扑结构 | 一个设备串口连接PC                                           |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                    |
| 测试步骤     | 调用aos_task_new_ext创建任务，指定任务函数，栈空间大小为1024 |
| 预期结果     | 串口正确打印出任务名称                                       |
| 备注         |                                                              |

1.  任务函数中调用aos_task_name获取任务名称并打印10次

2.  调用aos_task_exit退出任务

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 创建任务key

| 测试用例编号 | AOS-1-8                                   |
|--------------|-------------------------------------------|
| 测试用例     | 创建任务key                               |
| 测试目的     | 验证aos_task_key_create创建任务key        |
| 测试属性     | 必选\| P0 \| 功能用例                     |
| 测试设备     | 1.设备，2.串口线，3.PC                    |
| 测试拓扑结构 | 一个设备串口连接PC                        |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes |
| 测试步骤     | 调用aos_task_new创建任务                  |
| 预期结果     | 步骤2中创建的任务key非NULL                |
| 备注         |                                           |

1.  任务函数中调用aos_task_key_create创建任务key

2.  任务函数中调用aos_task_name获取任务名称并打印10次

3.  调用aos_task_exit退出任务

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 删除任务key

| 测试用例编号 | AOS-1-9                                   |
|--------------|-------------------------------------------|
| 测试用例     | 删除任务key                               |
| 测试目的     | 验证aos_task_key_delete删除任务key        |
| 测试属性     | 必选\| P0 \| 功能用例                     |
| 测试设备     | 1.设备，2.串口线，3.PC                    |
| 测试拓扑结构 | 一个设备串口连接PC                        |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes |
| 测试步骤     | 调用aos_task_new创建任务                  |
| 预期结果     | 步骤2中创建的任务key非NULL                |
| 备注         |                                           |

1.  任务函数中调用aos_task_key_create创建任务key

2.  调用aos_task_key_delete删除任务key

3.  任务函数中调用aos_task_name获取任务名称并打印10次

4.  调用aos_task_exit退出任务

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设置/获取任务值

| 测试用例编号 | AOS-1-10                                                         |
|--------------|------------------------------------------------------------------|
| 测试用例     | 设置/获取任务值                                                  |
| 测试目的     | 验证aos_task_setspecific/aos_task_getspecific设置/获取任务私有值 |
| 测试属性     | 必选\| P0 \| 功能用例                                            |
| 测试设备     | 1.设备，2.串口线，3.PC                                           |
| 测试拓扑结构 | 一个设备串口连接PC                                               |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                        |
| 测试步骤     | 调用aos_task_new创建任务                                         |
| 预期结果     | 步骤2中创建的任务key非NULL                                       |
| 备注         |                                                                  |

1.  任务函数中调用aos_task_key_create创建任务key

2.  调用aos_task_setspecific设置任务值，入参为整型全局变量A指针，值为0x5a5a

3.  调用aos_task_getspecific获取任务值

4.  修改全局变量A的值为0xa5a5

5.  再次调用aos_task_getspecific获取任务值

6.  任务函数中调用aos_task_name获取任务名称并打印10次

7.  调用aos_task_exit退出任务

8.  步骤4获取的任务值为0x5a5a

9.  步骤6获取的任务值为0xa5a5

10. 系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 创建大量任务

| 测试用例编号 | AOS-1-11                                              |
|--------------|-------------------------------------------------------|
| 测试用例     | 创建大量任务                                          |
| 测试目的     | 验证aos_task_new创建大量任务并稳定运行                |
| 测试属性     | 必选\| P0 \| 稳定性用例                               |
| 测试设备     | 1.设备，2.串口线，3.PC                                |
| 测试拓扑结构 | 一个设备串口连接PC                                    |
| 测试预置条件 | 空闲RAM足够大以支持20个任务栈                         |
| 测试步骤     | 调用aos_task_new创建20个任务T1\~T20（任务名各不相同） |
| 预期结果     | 20个任务创建成功并打印出20个任务名称                  |
| 备注         |                                                       |

1.  任务T1\~T20中调用aos_task_name打印任务名称

2.  任务T1\~T20调用aos_task_exit退出任务

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 反复创建/销毁任务

| 测试用例编号 | AOS-1-12                                  |
|--------------|-------------------------------------------|
| 测试用例     | 反复创建/销毁任务                         |
| 测试目的     | 验证反复创建/销毁任务系统稳定运行         |
| 测试属性     | 必选\| P0 \| 稳定性用例                   |
| 测试设备     | 1.设备，2.串口线，3.PC                    |
| 测试拓扑结构 | 一个设备串口连接PC                        |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes |
| 测试步骤     | 初始化全局变量A=0                         |
| 预期结果     | 10W次循环结束后A=100000                   |
| 备注         |                                           |

1.  调用aos_sem_new创建用于同步的信号量S0，count=0

2.  循环体中调用aos_task_new创建任务T0

3.  T0中休眠100ms后调用aos_sem_signal释放信号量，count=1，A++，调用aos_task_exit退出任务

4.  循环体中调用aos_sem_wait(S0,-1)阻塞获取信号量（直到T0释放信号量）

5.  循环10W次任务创建与销毁

6.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

多任务通信
----------

### 互斥锁创建与销毁

| 测试用例编号 | AOS-1-13                                          |
|--------------|---------------------------------------------------|
| 测试用例     | 互斥锁创建与销毁                                  |
| 测试目的     | 验证aos_mutex_new /aos_mutex_free互斥锁创建与销毁 |
| 测试属性     | 必选\| P0 \| 功能用例                             |
| 测试设备     | 1.设备，2.串口线，3.PC                            |
| 测试拓扑结构 | 一个设备串口连接PC                                |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes         |
| 测试步骤     | 调用aos_mutex_new创建互斥锁M0                     |
| 预期结果     | 互斥锁创建/销毁成功                               |
| 备注         |                                                   |

1.  调用aos_mutex_lock(M0, 1000)尝试上锁

2.  调用aos_mutex_lock(M0, 1000)尝试上锁

3.  调用aos_mutex_unlock(M0)解锁

4.  调用aos_mutex_free销毁互斥锁

5.  步骤2上锁成功，无阻塞

6.  步骤3上锁失败，阻塞时间约1000ms

7.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 使用互斥锁任务同步

| 测试用例编号 | AOS-1-14                                           |
|--------------|----------------------------------------------------|
| 测试用例     | 使用互斥锁任务同步                                 |
| 测试目的     | 验证aos_mutex_lock /aos_mutex_unlock互斥锁任务同步 |
| 测试属性     | 必选\| P0 \| 稳定性用例                            |
| 测试设备     | 1.设备，2.串口线，3.PC                             |
| 测试拓扑结构 | 一个设备串口连接PC                                 |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024\*5 Bytes       |
| 测试步骤     | 初始化全局变量signed int A=0                       |
| 预期结果     | 任务T1\~T5创建成功                                 |
| 备注         |                                                    |

1.  调用aos_mutex_new创建互斥锁M0

2.  调用aos_task_new创建5个任务T1\~T5

3.  任务T1\~T2上锁，全局变量A--，解锁，共循环10W次，aos_task_exit

4.  任务T3\~T5上锁，全局变量A++，解锁，共循环10W次，aos_task_exit

5.  等待T1\~T5任务退出，打印全局变量A的值

6.  调用aos_task_free销毁互斥锁

7.  互斥锁M0创建/销毁成功

8.  步骤6全局变量A=100000

9.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 信号量创建与销毁

| 测试用例编号 | AOS-1-15                                      |
|--------------|-----------------------------------------------|
| 测试用例     | 信号量创建与销毁                              |
| 测试目的     | 验证aos_sem_new /aos_sem_free互斥锁创建与销毁 |
| 测试属性     | 必选\| P0 \| 功能用例                         |
| 测试设备     | 1.设备，2.串口线，3.PC                        |
| 测试拓扑结构 | 一个设备串口连接PC                            |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes     |
| 测试步骤     | 调用aos_sem_new创建信号量S0，count=0          |
| 预期结果     | 信号量创建/销毁成功                           |
| 备注         |                                               |

1.  调用aos_sem_wait(S0,1000)

2.  调用aos_sem_signal(S0)

3.  调用aos_sem_wait(S0,1000)

4.  调用aos_sem_free销毁信号量S0

5.  步骤2获取信号量失败，阻塞1000ms

6.  步骤4获取信号量成功，无阻塞

7.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 使用信号量任务同步

| 测试用例编号 | AOS-1-16                                       |
|--------------|------------------------------------------------|
| 测试用例     | 使用信号量任务同步                             |
| 测试目的     | 验证aos_sem_wait /aos_sem_signal互斥锁任务同步 |
| 测试属性     | 必选\| P0 \| 稳定性用例                        |
| 测试设备     | 1.设备，2.串口线，3.PC                         |
| 测试拓扑结构 | 一个设备串口连接PC                             |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024\*10 Bytes  |
| 测试步骤     | 调用aos_sem_new创建信号量S0，count=-9          |
| 预期结果     | 任务T1\~T10创建成功                            |
| 备注         |                                                |

1.  调用aos_task_new创建10个任务T1\~T10

2.  任务T1\~T10调用aos_msleep(1000)，aos_sem_signal(S0)释放信号量，aos_task_exit

3.  父任务调用aos_sem_wait(S0，-1)等待10个信号量被释放

4.  调用aos_sem_free销毁信号量对象

5.  信号量S0创建/销毁成功

6.  步骤4阻塞10s后退出

7.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 队列创建与销毁

| 测试用例编号 | AOS-1-17                                        |
|--------------|-------------------------------------------------|
| 测试用例     | 队列创建与销毁                                  |
| 测试目的     | 验证aos_queue_new /aos_queue_free创建与销毁队列 |
| 测试属性     | 必选\| P0 \| 功能用例                           |
| 测试设备     | 1.设备，2.串口线，3.PC                          |
| 测试拓扑结构 | 一个设备串口连接PC                              |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes       |
| 测试步骤     | 调用aos_queue_new创建队列Q0                     |
| 预期结果     | 队列创建/销毁成功                               |
| 备注         |                                                 |

1.  调用aos_queue_recv(Q0,1000,msg,size)从队列Q0接收数据，阻塞1000ms

2.  调用aos_queue_send(Q0,msg,size)向队列Q0发送数据

3.  调用aos_queue_recv(Q0,1000,msg,size)从队列Q0接收数据，阻塞1000ms

4.  调用aos_queeu_free销毁队列Q0

5.  步骤2从队列Q0接收超时失败，阻塞1000ms

6.  步骤4从队列Q0接收成功，无阻塞

7.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 使用队列任务同步

| 测试用例编号 | AOS-1-18                                          |
|--------------|---------------------------------------------------|
| 测试用例     | 使用队列任务同步                                  |
| 测试目的     | 验证aos_queue_send/aos_queue_recv多任务间数据通信 |
| 测试属性     | 必选\| P0 \| 稳定性用例                           |
| 测试设备     | 1.设备，2.串口线，3.PC                            |
| 测试拓扑结构 | 一个设备串口连接PC                                |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes         |
| 测试步骤     | 初始化全局变量signed int A=0                      |
| 预期结果     | 任务T1\~T5创建成功                                |
| 备注         |                                                   |

1.  调用aos_queue_new创建队列Q1\~Q4

2.  调用aos_task_new创建任务T1\~T5

3.  任务T2从队列Q1阻塞接收，接收到之后将数据发送大队列Q2

4.  任务T3从队列Q2阻塞接收，接收到之后将数据发送大队列Q3

5.  任务T4从队列Q3阻塞接收，接收到之后将数据发送大队列Q4

6.  任务T5从队列Q4阻塞接收，接收到之后将数据打印

7.  任务T1以10ms为周期向队列Q1发送数据A，A++，循环10W次

8.  调用aos_queue_free销毁队列Q1\~Q4

9.  队列Q1\~Q4创建/销毁成功

10. 任务T5最后一次打印全局变量A=100000

11. 系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

定时器
------

### 定时器创建与销毁

| 测试用例编号 | AOS-1-19                                                 |
|--------------|----------------------------------------------------------|
| 测试用例     | 定时器创建与销毁                                         |
| 测试目的     | 验证aos_timer_new /aos_timer_free创建与销毁定时器        |
| 测试属性     | 必选\| P0 \| 功能用例                                    |
| 测试设备     | 1.设备，2.串口线，3.PC                                   |
| 测试拓扑结构 | 一个设备串口连接PC                                       |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                |
| 测试步骤     | 调用aos_timer_new创建定时器TM0，定时周期1000ms，repeat=1 |
| 预期结果     | 定时器创建/销毁成功                                      |
| 备注         |                                                          |

1.  定时器TM0回调函数中调用aos_now打印当前时刻

2.  调用aos_timer_start(TM0)启动定时器TM0

3.  10s后调用aos_tmier_stop(TM0)停止定时器TM0

4.  10s后调用aos_timer_free(TM0)销毁定时器TM0

5.  定时器start之前不会触发回调

6.  定时器start之后，stop之前每隔约1000ms触发回调

7.  定时器stop后停止运行，不再触发回调

8.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 定时器周期修改

| 测试用例编号 | AOS-1-20                                                 |
|--------------|----------------------------------------------------------|
| 测试用例     | 定时器周期修改                                           |
| 测试目的     | 验证aos_timer_change修改定时器定时周期                   |
| 测试属性     | 必选\| P0 \| 功能用例                                    |
| 测试设备     | 1.设备，2.串口线，3.PC                                   |
| 测试拓扑结构 | 一个设备串口连接PC                                       |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                |
| 测试步骤     | 调用aos_timer_new创建定时器TM0，定时周期1000ms，repeat=1 |
| 预期结果     | 定时器创建/销毁成功                                      |
| 备注         |                                                          |

1.  定时器TM0回调函数中调用aos_now打印当前时刻

2.  调用aos_timer_start(TM0)启动定时器TM0

3.  10s后调用aos_timer_change(TM0,2000)

4.  10s后调用aos_tmier_stop(TM0)停止定时器TM0

5.  调用aos_timer_free(TM0)销毁定时器TM0

6.  定时器start之前不会触发回调

7.  定时器start之后，先以1000ms周期触发回调，10s后以2000ms周期触发回调

8.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

AliOS Things 组件测试
=====================

KV
--

### 读写KV

| 测试用例编号 | AOS-2-1                                   |
|--------------|-------------------------------------------|
| 测试用例     | 读写KV                                    |
| 测试目的     | 验证aos_kv_set/aos_kv_get读写KV           |
| 测试属性     | 必选 \| P0 \| 功能用例                    |
| 测试设备     | 1.设备，2.串口线，3.PC                    |
| 测试拓扑结构 | 一个设备串口连接PC                        |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes |
| 测试步骤     | 调用aos_kv_set写KV对                      |
| 预期结果     | 读写KV对成功                              |
| 备注         |                                           |

1.  调用aos_kv_get读KV对

2.  读出的value与写入的value相同

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 删除KV

| 测试用例编号 | AOS-2-2                                   |
|--------------|-------------------------------------------|
| 测试用例     | 删除KV                                    |
| 测试目的     | 验证aos_kv_del删除KV对                    |
| 测试属性     | 必选\| P0 \| 功能用例                     |
| 测试设备     | 1.设备，2.串口线，3.PC                    |
| 测试拓扑结构 | 一个设备串口连接PC                        |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes |
| 测试步骤     | 调用aos_kv_del删除存在的KV对kv1           |
| 预期结果     | 步骤2读KV对失败，步骤1删除KV对成功        |
| 备注         |                                           |

1.  调用aos_kv_get读KV对kv1，

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 读写删稳定性

| 测试用例编号 | AOS-2-3                                                 |
|--------------|---------------------------------------------------------|
| 测试用例     | 读写删稳定性                                            |
| 测试目的     | 验证aos_kv_set/aos_kv_get/aos_kv/del写读删KV对          |
| 测试属性     | 必选\| P0 \| 稳定性用例                                 |
| 测试设备     | 1.设备，2.串口线，3.PC                                  |
| 测试拓扑结构 | 一个设备串口连接PC                                      |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes               |
| 测试步骤     | 调用aos_kv_set增加KV对，key和value长度为255字节         |
| 预期结果     | 步骤2读出的value与步骤1写入的value相同，10W次正确率100% |
| 备注         |                                                         |

1.  调用aso_kv_get读KV对

2.  调用aos_kv_del删除KV对

3.  步骤1\~3循环10W次

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

Yloop
-----

### 事件注册与注销

| 测试用例编号 | AOS-2-4                                                                    |
|--------------|----------------------------------------------------------------------------|
| 测试用例     | 事件注册与注销                                                             |
| 测试目的     | 验证aos_register_event_filter/aos_unregister_event_filter注册/注销系统事件 |
| 测试属性     | 必选\| P0 \| 功能用例                                                      |
| 测试设备     | 1.设备，2.串口线，3.PC                                                     |
| 测试拓扑结构 | 一个设备串口连接PC                                                         |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                                  |
| 测试步骤     | 调用aos_register_event_filter注册事件EVENT0，指定事件回调CB0               |
| 预期结果     | 步骤2触发事件后，回调函数CB0被调用                                         |
| 备注         |                                                                            |

1.  回调CB0中调用aos_loop_exit退出事件循环

2.  调用aos_post_event触发事件EVENT0

3.  调用aos_loop_run运行主事件循环

4.  调用aos_unregister_event_filter注销事件EVNET0

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 定时任务注册/取消

| 测试用例编号 | AOS-2-5                                                                |
|--------------|------------------------------------------------------------------------|
| 测试用例     | 定时任务注册/取消                                                      |
| 测试目的     | 验证aos_post_delayed_action/aos_cancel_delayed_action注册/取消定时任务 |
| 测试属性     | 必选\| P0 \| 功能用例                                                  |
| 测试设备     | 1.设备，2.串口线，3.PC                                                 |
| 测试拓扑结构 | 一个设备串口连接PC                                                     |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                              |
| 测试步骤     | 调用aos_post_delayed_action注册1000ms定时任务，回调为CB0               |
| 预期结果     | 1000ms后定时任务被触发，CB0被调用                                      |
| 备注         |                                                                        |

1.  回调CB0中调用aos_post_delayed_acion注册1000ms定时任务，回调为CB0，调用aos_cancel_delayed_action取消定时任务

2.  main loop等待3000ms

3.  2000ms后CB0不再被调用

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 自定义事件循环

| 测试用例编号 | AOS-2-6                                                 |
|--------------|---------------------------------------------------------|
| 测试用例     | 自定义事件循环                                          |
| 测试目的     | 验证aos_loop_init定义task的事件循环                     |
| 测试属性     | 必选\| P0 \| 功能用例                                   |
| 测试设备     | 1.设备，2.串口线，3.PC                                  |
| 测试拓扑结构 | 一个设备串口连接PC                                      |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes               |
| 测试步骤     | 调用aos_task_new创建新任务T0                            |
| 预期结果     | 1000ms后定时任务被触发，CB0被调用，任务T0的事件循环退出 |
| 备注         |                                                         |

1.  任务T0中调用aos_loop_init初始化T0的事件循环

2.  任务T0调用aos_post_delayed_action注册1000ms延时action，回调CB0中aos_loop_exit退出当前事件循环

3.  任务T0调用aos_loop_run开始事件循环

4.  任务T0中aos_loop_run返回后调用aos_loop_destroy

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 事件循环运行与停止

| 测试用例编号 | AOS-2-7                                                                    |
|--------------|----------------------------------------------------------------------------|
| 测试用例     | 事件循环运行与停止                                                         |
| 测试目的     | 验证aos_loop_run/aos_loop_exit运行/停止事件循环                            |
| 测试属性     | 必选\| P0 \| 功能用例                                                      |
| 测试设备     | 1.设备，2.串口线，3.PC                                                     |
| 测试拓扑结构 | 一个设备串口连接PC                                                         |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                                  |
| 测试步骤     | 调用aos_post_delayed_action注册1000ms延时action，回调CB0中退出当前事件循环 |
| 预期结果     | 1000ms后定时任务被触发，CB0被调用，事件循环退出，无阻塞                    |
| 备注         |                                                                            |

1.  调用aos_loop_run开始运行当前事件循环

2.  aos_loop_run返回后调用aos_loop_destroy销毁事件循环

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 触发大量事件

| 测试用例编号 | AOS-2-8                                                                   |
|--------------|---------------------------------------------------------------------------|
| 测试用例     | 触发大量事件                                                              |
| 测试目的     | 验证注册与触发大量事件系统稳定运行                                        |
| 测试属性     | 必选\| P0 \| 稳定性用例                                                   |
| 测试设备     | 1.设备，2.串口线，3.PC                                                    |
| 测试拓扑结构 | 一个设备串口连接PC                                                        |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024 Bytes                                 |
| 测试步骤     | main loop调用aos_post_delayed_action注册1000个1000ms延时action，回调为CB0 |
| 预期结果     | 1000ms后CB0被调用1000次                                                   |
| 备注         |                                                                           |

1.  main loop等待2000ms

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 自定义大量事件循环

| 测试用例编号 | AOS-2-9                                                                     |
|--------------|-----------------------------------------------------------------------------|
| 测试用例     | 自定义大量事件循环                                                          |
| 测试目的     | 验证大量事件循环正常稳定运行                                                |
| 测试属性     | 必选\| P0 \| 稳定性用例                                                     |
| 测试设备     | 1.设备，2.串口线，3.PC                                                      |
| 测试拓扑结构 | 一个设备串口连接PC                                                          |
| 测试预置条件 | 设备上电开机后空闲的RAM空间 \> 1024\*10 Bytes                               |
| 测试步骤     | 调用aos_task_new创建10个任务T0\~T9                                          |
| 预期结果     | 1000ms后T0\~T9注册的延时action被触发，CB0被调用，T0\~T9事件循环退出，无阻塞 |
| 备注         |                                                                             |

1.  任务T0\~T9分别调用aos_loop_init创建自定义事件循环，并aos_post_delayed_action注册1000ms延时action，回调CB0中退出当前事件循环

2.  T0\~T9调用aos_loop_run运行各自事件循环等待1000ms后延时action触发

3.  T0\~T9中aos_loop_run返回后调用aos_loop_destroy销毁事件循环

4.  aos_loop_run返回后调用aos_loop_destroy销毁事件循环

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

uMesh
-----

### Help指令

| 测试用例编号 | AOS-2-10                                                                                                                                                                                                                                                                                             |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Help指令                                                                                                                                                                                                                                                                                             |
| 测试目的     | 利用help查看mesh中所有支持的指令                                                                                                                                                                                                                                                                     |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                                                                             |
| 测试拓扑结构 | 一个设备串口连接PC                                                                                                                                                                                                                                                                                   |
| 测试预置条件 | 设备进入mesh环境                                                                                                                                                                                                                                                                                     |
| 测试步骤     | 在设备的中输入umesh help                                                                                                                                                                                                                                                                             |
| 预期结果     | 列出所有支持的指令： extnetid——查看并设置mesh网络隔离地址，搭建不同的mesh环境 nbrs——打印节点探测到的邻居节点 start——开启mesh网络 stats——查看统计信息 status——查看此设备所有信息 stop——断开mesh网络 ipaddr——打印网络的ipv4地址（包括：子节点地址、全网广播地址） ping——ping网络中的节点（测试连通性） |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                                                                                                           |

1.  被测设备与AP相对位置见 附录D：mesh测试设备与AP相对位置示意图

### Status查看

| 测试用例编号 | AOS-2-11                                                          |
|--------------|-------------------------------------------------------------------|
| 测试用例     | Status查看                                                        |
| 测试目的     | 查看设备相关信息：sid，mac，netid等                               |
| 测试属性     | 必选\| P2 \| 功能用例                                             |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                          |
| 测试拓扑结构 | 一个mesh网络：leader+router+router+ router，每种角色各一个设备    |
| 测试预置条件 | 按上面拓扑结构搭环境                                              |
| 测试步骤     | 1．在四个设备的console分别执行umesh status命令                    |
| 预期结果     | 步骤1：显示设备的state、netid、mac、attach、netsize、 channel信息 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                        |

### Neighbor发现功能

| 测试用例编号 | AOS-2-12                                                                                                                              |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Neighbor发现功能                                                                                                                      |
| 测试目的     | 验证网络中存在一个或多个设备时，Neighbor的发现功能是否正确                                                                            |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                 |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                              |
| 测试拓扑结构 | 一个设备或者多个设备串口连接PC                                                                                                        |
| 测试预置条件 | 设备进入mesh环境。                                                                                                                    |
| 测试步骤     | 1．网络中仅有leader ，在leader的 console执行umesh nbrs命令。 2．新增一个或多个设备接入mesh网络，在各自设备的console执行umesh nbrs命令 |
| 预期结果     | 步骤1：无法查看neighbor信息 步骤2：每个设备都能发现网络中除自己以外的其他所有设备                                                     |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                            |

### 不同mesh网络间Neighbor信息隔离

| 测试用例编号 | AOS-2-13                                                                                                                                     |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 不同mesh网络间Neighbor信息隔离                                                                                                               |
| 测试目的     | 验证不同mesh网络中查看neighbor是不是隔离                                                                                                     |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                     |
| 测试拓扑结构 | 1. 4个设备，每2个连接不同ap（两AP的ssid，pw，channel都不同），组建两个mesh网络A,网络B。 2. mesh网络A,网络B中，各配置一个leader，另一个router |
| 测试预置条件 | 按上面拓扑结构搭环境                                                                                                                         |
| 测试步骤     | 在四个设备的console分别执行umesh nbrs命令                                                                                                    |
| 预期结果     | 每个设备只能发现一条neighbor信息，且该条neighbor信息为各自mesh网络中除自己之外的那个设备                                                     |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                   |

1.  设备与路由器的相对位置见

2.  在四个设备的console分别执行umesh status命令

3.  A网络中两个设备的netid是X，B网络中两个设备的netid是Y，且X不等于Y

### 同一个mesh网络meshnetid和meshnetsize一致性

| 测试用例编号 | AOS-2-14                                             |
|--------------|------------------------------------------------------|
| 测试用例     | 同一个mesh网络meshnetid和meshnetsize一致性           |
| 测试目的     | 验证同一个mesh网络内的meshnetid和meshnetsize是否一致 |
| 测试属性     | 必选\| P0 \| 功能用例                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC             |
| 测试拓扑结构 | 一个mesh网络：leader+router+router+ router           |
| 测试预置条件 | 按上面的拓扑结构部署环境                             |
| 测试步骤     | 1．四个设备的console均执行umesh status命令           |
| 预期结果     | 1．所有设备的netid和netsize一致                      |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）           |

### 查看IP地址

| 测试用例编号 | AOS-2-15                                                                                                                                                                                               |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 查看IP地址                                                                                                                                                                                             |
| 测试目的     | 查看设备的IP地址和广播地址                                                                                                                                                                             |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                  |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                               |
| 测试拓扑结构 | 有且只有一个mesh网络 任何拓扑结构                                                                                                                                                                      |
| 测试预置条件 | 同上                                                                                                                                                                                                   |
| 测试步骤     | 在设备A的console输入：umesh ipaddr， 对于ipv6如下： fc00:0:0:ff00:0:0:0:1000 fc00:0:0:ff00:260a:c404:c944:0 ff08:0:0:fffe:0:0:0:fc 对于ipv4如下： 10.0.16.2 224.0.0.252                                |
| 预期结果     | 对于ipv6：第一行是含有sid的IP地址（地址会变），第二行是有mac地址的IP地址（即UEID地址，地址固定），第三行是多播地址 对于ipv4：第一行是本地地址，第二行是多播地址                                        |
| 备注         | 【本地IPv4地址和uMesh短地址之间映射关系。此处本地地址是10.0.A.B。那么sid = (A \<\< 8 + B -2)。如某一节点sid = 0x1000，那么对应的IPv4本地地址是10.0.16.2。】 802.15.4组网、BLE组网（此2种组网功能暂无） |

### Leader连AP，其它节点不连AP组网

| 测试用例编号 | AOS-2-16                                                                                                                                                 |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Leader连AP，其它节点不连AP组网                                                                                                                           |
| 测试目的     | 验证Leader连AP，其它节点不连AP组网是否成功                                                                                                               |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                    |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                 |
| 测试拓扑结构 | 拓扑结构随意                                                                                                                                             |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                               |
| 测试步骤     | 1.将leader节点配网成功，其它3个节点不连接AP                                                                                                              |
| 预期结果     | 1.几分钟后，其它节点依然挂在leader节点下面，拓扑结构不变，节点间能ping通                                                                                 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） 连接AP成功的节点必定成为mesh网络中的leader 后续均可以在一个节点连接AP成为leader，其他节点不连AP组网拓扑下测试 |

### Fixed模式—leader和router

| 测试用例编号 | AOS-2-17                                                                                                                   |
|--------------|----------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—leader和router                                                                                                   |
| 测试目的     | 验证Fixed模式下leader和router的角色形成                                                                                    |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                      |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                   |
| 测试拓扑结构 | 当前无任何mesh网络环境                                                                                                     |
| 测试预置条件 | 准备设备A和B                                                                                                               |
| 测试步骤     | 设备A进入mesh环境，等一分钟 设备B进入mesh环境，等一分钟 在设备A的console中执行umesh nbrs                                   |
| 预期结果     | 步骤1：设备Ａ默认成为leader节点 步骤2：设备Ｂ默认成为router节点 步骤3：能够看到设备B的macaddr和sid，且设备B在A的children中 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                 |

### Fixed模式—ping IP地址

| 测试用例编号 | AOS-2-18                                                                                                                                                                                                   |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—ping IP地址                                                                                                                                                                                      |
| 测试目的     | 验证fixed模式下所有节点是否都能相互ping通                                                                                                                                                                  |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                      |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                   |
| 测试拓扑结构 | 1.当前只有一个mesh环境 2. 当前mesh网络中有一个leader和3个router（A，B和C）                                                                                                                                 |
| 测试预置条件 | 同上                                                                                                                                                                                                       |
| 测试步骤     | 1. Leader分别ping其它三个router节点ping IP【例：ping 10.0.16.2（ipv4地址）或者ping fc00:0:0:6800:0:10（ipv6地址）】 2. Router A ping其它三个节点 3. Router B ping其它三个节点 4. Router C ping其它三个节点 |
| 预期结果     | 步骤1：能够正常ping通，能收到对应节点回复打印 步骤2：能够正常ping通，能收到对应节点回复打印 步骤3：能够正常ping通，能收到对应节点回复打印 步骤4：能够正常ping通，能收到对应节点回复打印                    |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） **目前暂只支持ipv4地址网络**                                                                                                                                    |

### Fixed模式—ping UEID地址

| 测试用例编号 | AOS-2-19                                                                                                                                                                                |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—ping UEID地址                                                                                                                                                                 |
| 测试目的     | 验证fixed模式下所有节点用UEID是否都能相互ping通                                                                                                                                         |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                   |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                |
| 测试拓扑结构 | 1.当前只有一个mesh环境 2. 当前mesh网络中有一个leader和3个router（A，B和C）                                                                                                              |
| 测试预置条件 | 同上                                                                                                                                                                                    |
| 测试步骤     | 1.leader节点分别ping其它三个router节点的UEID地址（例：ping fc00:0:0:6800:260a:c404:c944:0） 2.Router A　ping其它三个节点 3.Router B　ping其它三个节点 4.Router C　ping其它三个节点      |
| 预期结果     | 步骤1：能够正常ping通，能收到对应节点回复打印 步骤2：能够正常ping通，能收到对应节点回复打印 步骤3：能够正常ping通，能收到对应节点回复打印 步骤4：能够正常ping通，能收到对应节点回复打印 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） **此项只针对ipv6地址网络，目前暂只支持ipv4地址网络**                                                                                         |

### Fixed模式—多字节ping IP地址

| 测试用例编号 | AOS-2-20                                                                                                                                                                                                                  |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—多字节ping IP地址                                                                                                                                                                                               |
| 测试目的     | 验证fixed模式下所有节点是否都能相互ping通                                                                                                                                                                                 |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                     |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                  |
| 测试拓扑结构 | 1.当前只有一个mesh环境 2.当前mesh网络中有１个leader和3个router（A，B和C）                                                                                                                                                 |
| 测试预置条件 | 同上                                                                                                                                                                                                                      |
| 测试步骤     | 1.leader节点分别ping其它三个router节点ping IP X【例：ping 10.0.16.2 1000（ipv4地址）或者 ping fc00:0:0:6800:0:1000 1000（ipv6地址）】 2.Router A ping其它三个节点 3.Router B ping其它三个节点 4.Router C ping其它三个节点 |
| 预期结果     | 步骤1：能够正常ping通，能收到对应节点回复打印 步骤2：能够正常ping通，能收到对应节点回复打印 步骤3：能够正常ping通，能收到对应节点回复打印 步骤4：能够正常ping通，能收到对应节点回复打印                                   |
| 备注         | ping IP X此处的X为多字节，最大值是1492 802.15.4组网下再测一次 **目前暂只支持ipv4地址网络**                                                                                                                                |

### Fixed模式—多字节ping UEID地址

| 测试用例编号 | AOS-2-21                                                                                                                                                                                 |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—多字节ping UEID地址                                                                                                                                                            |
| 测试目的     | 验证fixed模式下所有节点用UEID多字节是否都能相互ping通                                                                                                                                    |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                    |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                 |
| 测试拓扑结构 | 1.当前只有一个mesh环境 2.当前mesh网络中有１个leader和3个router（A，B和C）                                                                                                                |
| 测试预置条件 | 同上                                                                                                                                                                                     |
| 测试步骤     | 1.leader节点ping分别ping其它三个router节点的UEID地址（例：ping fc00:0:0:6800:260a:c404:c944:0 1000） 2.Router A ping其它三个节点 3.Router B ping其它三个节点 4.Router C ping其它三个节点 |
| 预期结果     | 步骤1：能够正常ping通，能收到对应节点回复打印 步骤2：能够正常ping通，能收到对应节点回复打印 步骤3：能够正常ping通，能收到对应节点回复打印 步骤4：能够正常ping通，能收到对应节点回复打印  |
| 备注         | ping fc00:0:0:6800:260a:c404:c944:0 1000为多字节，最大值是1492； 802.15.4组网、BLE组网（此2种组网功能暂无） **此项只针对ipv6地址网络，目前暂只支持ipv4地址网络**                         |

### Fixed模式—ping多字节的极限值测试

| 测试用例编号 | AOS-2-22                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—ping多字节的极限值测试                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 测试目的     | 验证fixed模式下ping最大值字节，和超过最大值是否正常                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 测试拓扑结构 | 1.当前只有一个mesh环境 2.当前mesh网络中有１个leader和3个router（A，B和C）                                                                                                                                                                                                                                                                                                                                                                                                            |
| 测试预置条件 | 同上                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 测试步骤     | 1. 任一节点分别用最大值字节ping其它三个节点【例：ping 10.0.16.2 1492（ipv4地址）或者 ping fc00:0:0:6800:0:1000 1492（ipv6地址）】 2.任一节点分别用超过最大值字节ping其它三个节点【例：ping 10.0.16.2 1493（ipv4地址）或者 ping fc00:0:0:6800:0:1000 1493（ipv6地址）】 3.任一节点分别用最大值字节ping其它三个节点的UEID地址（例：ping fc00:0:0:6800:260a:c404:c944:0 1492） 4.任一节点分别用超过最大值字节ping其它三个节点的UEID地址（例：ping fc00:0:0:6800:260a:c404:c944:0 1493） |
| 预期结果     | 步骤1：能够正常ping通，能收到对应节点回复打印 步骤2：不能够ping通，提示“exceed mesh IP MTU 1500” 步骤3：能够正常ping通，能收到对应节点回复打印 步骤4：不能够ping通，提示“exceed mesh IP MTU 1500”                                                                                                                                                                                                                                                                                    |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） **目前暂只支持ipv4地址网络**                                                                                                                                                                                                                                                                                                                                                                                                              |

### Fixed模式—全网发送广播包（多播）

| 测试用例编号 | AOS-2-23                                                                                                                                                                    |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—全网发送广播包（多播）                                                                                                                                            |
| 测试目的     | 验证各节点全网发送广播包能否成功                                                                                                                                            |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                    |
| 测试拓扑结构 | 1.当前周边已有且只有一个构建的mesh网络                                                                                                                                      |
|              | 2.当前mesh网络中有一个leader节点和3个router节点                                                                                                                             |
| 测试预置条件 | 同上                                                                                                                                                                        |
| 测试步骤     | 1.每个节点上分别执行ping 224.0.0.252 2.每个节点上执行指定长度的广播，执行命令是ping 224.0.0.252 X（ipv4地址）或者ping ff08:0:0:fffe:0:0:0:fc X（ipv6地址） 3.步骤2执行100次 |
| 预期结果     | 步骤1：能够正常ping通，能收到所有节点回复打印 步骤2：能够正常ping通，能收到所有节点回复打印。 步骤3：能够正常ping通，能收到所有节点回复打印，丢包率不得高于**20%**（待定）  |
| 备注         | X为字节长度，范围在1\~1492 丢包率与硬件WiFi底层相关 802.15.4组网、BLE组网（此2种组网功能暂无） **目前暂只支持ipv4地址网络**                                                 |

### Fixed模式—router节点回收

| 测试用例编号 | AOS-2-24                                                                                                                                                      |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—router节点回收                                                                                                                                      |
| 测试目的     | 验证router节点能否回收                                                                                                                                        |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                         |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                      |
| 测试拓扑结构 | 1.当前周边已有且只有一个构建的mesh网络                                                                                                                        |
|              | 2.当前mesh网络中有一个leader节点（sid:0x0），3个router节点（sid分别为1000,2000和3000）                                                                        |
| 测试预置条件 | 按照上面的拓扑结构搭建环境 另外准备一个设备X备用                                                                                                              |
| 测试步骤     | sid为XXXX的节点A的console执行umesh stop，等待五分钟 设备X进入该mesh网络，在其console中执行umesh status                                                        |
| 预期结果     | 步骤1：其他某个节点console输入umesh nbrs，发现节点A已不在nbrs列表 步骤2：设备X的节点sid为XXXX，且其他节点console输入umesh nbrs，能够发现设备X的sids显示是XXXX |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                    |

### Fixed模式—Router节点stop再start后的角色变化

| 测试用例编号 | AOS-2-25                                                                                                                                     |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—Router节点stop再start后的角色变化                                                                                                  |
| 测试目的     | 验证router节点断开再连接后的角色变化                                                                                                         |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                     |
| 测试拓扑图   | 1.当前周边已有且只有一个构建的mesh网络                                                                                                       |
|              | 2.当前mesh网络中有一个leader节点（sid:0x0），2个router节点（sid分别为1000，2000）                                                            |
| 测试预置条件 | 按照上面的拓扑结构搭建环境 另外准备一个设备S备用                                                                                             |
| 测试步骤     | 1. sid为XXXX的router节点执行stop命令，2分钟内接入新的设备S 2.原sid为XXXX的router节点执行start命令                                            |
| 预期结果     | 步骤1. 成为新的router，且sid获取为0x3000，其他节点ping此节点能够ping通 步骤2. sid为XXXX的节点start后仍然是XXXX，其他节点ping此节点能够ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                   |

### Fixed模式—Leader节点stop后再start的角色变化(Leader连AP)

| 测试用例编号 | AOS-2-26                                                                                                                                                                                                             |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—Leader节点stop后再start的角色变化(Leader连AP)                                                                                                                                                              |
| 测试目的     | 验证leader节点断开后再连接的节点角色变化                                                                                                                                                                             |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                             |
| 测试拓扑结构 | 1个mesh网络：1个leader，3个router                                                                                                                                                                                    |
| 测试预置条件 | 1.有且只有一个mesh网络 2.按照上面的拓扑结构部署环境                                                                                                                                                                  |
| 测试步骤     | 1．leader节点执行umesh stop命令，等待5分钟 2．leader节点执行umesh start命令，等待8分钟左右 3．leader节点执行stop命令，不到1分钟后再执行start命令，等待8分钟                                                          |
| 预期结果     | 步骤1：原先3个router节点会选举出一个节点成为leader节点，其他节点ping此节点能够ping通； 步骤2：原leader节点再次变成leader节点，其它节点会挂在这个leader下面，节点间能够相互ping通 步骤3：拓扑不变，节点间能相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                           |

### Fixed模式—Leader节点stop后再start的角色变化(Leader未连AP)

| 测试用例编号 | AOS-2-27                                                                                                                                                         |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Fixed模式—Leader节点stop后再start的角色变化(Leader未连AP)                                                                                                        |
| 测试目的     | 验证leader节点断开后再连接的节点角色变化                                                                                                                         |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                            |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                         |
| 测试拓扑结构 | 1个mesh网络：1个leader，3个router                                                                                                                                |
| 测试预置条件 | 1.有且只有一个mesh网络 2.按照上面的拓扑结构部署环境                                                                                                              |
| 测试步骤     | 1.leader节点执行umesh stop命令，等待5分钟 2.leader节点执行umesh start命令                                                                                        |
| 预期结果     | 步骤1：原先3个router节点会选举出一个节点成为leader节点，其他节点ping此节点能够ping通； 步骤2：原leader节点重新接入后变为router节点，其他节点ping此节点能够ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                       |

### 改变AP的channel，所有设备仍然在同一个mesh网络中

| 测试用例编号 | AOS-2-28                                                                                 |
|--------------|------------------------------------------------------------------------------------------|
| 测试用例     | 改变AP的channel，所有设备仍然在同一个mesh网络中                                          |
| 测试目的     | 验证AP channel的改变，所有设备的channel也会跟着变化                                      |
| 测试属性     | 必选\| P1 \| 功能用例                                                                    |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                 |
| 测试拓扑结构 | 1.所有设备都连接同一个AP 2.设备的拓扑模式Leader+3router                                  |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                               |
| 测试步骤     | 1.设备都进入mesh环境 2.更改AP的channel值，保存。 3.等待一段时间后，查看各设备的channel值 |
| 预期结果     | 步骤3：设备的channel都为更改后的值，且所有设备的meshnetid是相同的，各节点间也能ping通    |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                               |

### Mesh网中的两个节点都连AP后拓扑结构的变化

| 测试用例编号 | AOS-2-29                                                                             |
|--------------|--------------------------------------------------------------------------------------|
| 测试用例     | Mesh网中的两个节点都连AP后拓扑结构的变化                                             |
| 测试目的     | 验证Mesh网中的两个节点都连AP后拓扑结构的变化                                         |
| 测试属性     | 必选\| P1 \| 功能用例                                                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                             |
| 测试拓扑结构 | 1个mesh网络：1个Leader，多个router                                                   |
| 测试预置条件 | 1.按上面拓扑结构搭建环境 2.确保没有节点连上AP                                        |
| 测试步骤     | 1.将leader节点A和某个router（或者super router）B都连上AP                             |
| 预期结果     | 1.一段时间后，A和B各自成为leader节点，剩下的节点都挂在A或者B，或者各自挂在AB下面均可 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                           |

### 两个mesh网络-设备的距离与网络合并无关联性

| 测试用例编号 | AOS-2-30                                                                              |
|--------------|---------------------------------------------------------------------------------------|
| 测试用例     | 两个mesh网络-设备的距离与网络合并无关联性                                             |
| 测试目的     | 验证不同的mesh网络的设备放在一起会不会发生网络合并                                    |
| 测试属性     | 必选\| P2 \| 功能用例                                                                 |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                              |
| 测试拓扑结构 | 两个mesh网络环境A和B（A和B的channel不同） A和B中各有一个设备                          |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                            |
| 测试步骤     | 1. 将这两块设备放到一起                                                               |
| 预期结果     | 1. 依然各自维持各自的mesh网络，分别在console中输入umesh status，显示各自的网络的netid |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                            |

### 两个mesh网络-不同mesh网络的设备之间无法ping通

| 测试用例编号 | AOS-2-31                                                                                                                                                                                             |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 两个mesh网络-不同mesh网络的设备之间无法ping通                                                                                                                                                        |
| 测试目的     | 验证不同mesh网络的设备之间无法ping通                                                                                                                                                                 |
| 测试属性     | 必选\| P2 \| 功能性用例                                                                                                                                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                             |
| 测试拓扑结构 | 1.当前周边已有两个mesh网络A和B（A和B的channel不同） 2.mesh网络A中有一个leader节点，2个routerX1、X2、X3节点（1000、2000、3000） 3. mesh网络B中有一个leader节点，3个router节点Y1、Y2节点（1000、2000） |
| 测试预置条件 | 同上                                                                                                                                                                                                 |
| 测试步骤     | 1．在网络A中节点X3的console中输入umesh ipaddr获取X3的IP 2．mesh网络B中的节点Y1去ping网络A中的节点X3                                                                                                  |
| 预期结果     | 步骤2：无法ping通                                                                                                                                                                                    |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） 因ipv4网络中的所有相同的sid的ip地址都是一样，故用这种方法对比                                                                                             |

### 两个mesh网络-AP断电不会影响其他mesh环境

| 测试用例编号 | AOS-2-32                                                                                                                                       |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 两个mesh网络-AP断电不会影响其他mesh环境                                                                                                        |
| 测试目的     | 验证AP断电不会影响其他mesh环境                                                                                                                 |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                          |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                       |
| 测试拓扑结构 | 1.设备连接两个不同的路由器，形成两个不同的mesh网络A和B 2.A和B的拓扑结构分别都是leader+router                                                   |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                     |
| 测试步骤     | 1.4个设备都执行umesh status 2.断开A网络的AP电源 3. 4个设备都执行umesh status                                                                   |
| 预期结果     | 步骤1：A网络中设备netid值为X，B网络中设备netid值为Y 步骤3：A网络中设备netid可能会发生变化，B网络中设备netid值仍为Y。A网络的断网不会影响到B网络 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                     |

### 距离测试—设备之间超出AP覆盖范围会各自成为leader

| 测试用例编号 | AOS-2-33                                                              |
|--------------|-----------------------------------------------------------------------|
| 测试用例     | 距离测试—设备之间超出AP覆盖范围会各自成为leader                       |
| 测试目的     | 验证设备之间超出AP覆盖范围是否会各自成为leader                        |
| 测试属性     | 必选\| P2 \| 功能用例                                                 |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                              |
| 测试拓扑结构 | 一个mesh环境：网络中有一个leader和一个router S                        |
| 测试预置条件 | 同上                                                                  |
| 测试步骤     | 1.两个设备的距离拉远到设备S检测不到leader                             |
| 预期结果     | 1.设备S自己会成为leader，在console中输入umesh status显示state为leader |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                            |

### 距离测试—相隔10米的设备之间能进行通信

| 测试用例编号 | AOS-2-34                                                |
|--------------|---------------------------------------------------------|
| 测试用例     | 距离测试—相隔10米的设备之间能进行通信                   |
| 测试目的     | 验证相隔10米的设备之间能否进行通信                      |
| 测试属性     | 必选\| P2 \| 功能用例                                   |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                |
| 测试拓扑结构 | 1.当前周边已有且只有一个构建的mesh网络                  |
|              | 2.任何拓扑                                              |
| 测试预置条件 | 节点设备之间相隔10米远                                  |
| 测试步骤     | 1.在节点B上输入umesh ipaddr获取IP地址 2.节点A ping节点B |
| 预期结果     | 步骤2：能够正常ping通，能收到对应节点回复打印           |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）              |

### 白名单—新增设备设置白名单后，会挂在白名单列表的设备下

| 测试用例编号 | AOS-2-35                                                                                                                                                                                                                     |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—新增设备设置白名单后，会挂在白名单列表的设备下                                                                                                                                                                        |
| 测试目的     | 验证新加入设备设置白名单后，是否会挂在白名单列表的设备下                                                                                                                                                                     |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                     |
| 测试拓扑结构 | 1.当前周边已有且只有一个构建的mesh网络                                                                                                                                                                                       |
|              | 2.当前mesh网络中有一个leader节点和一个router节点                                                                                                                                                                             |
| 测试预置条件 | 按照上面拓扑结构搭建环境 准备一个新设备S备用                                                                                                                                                                                 |
| 测试步骤     | 1.在节点X和新设备S的console中输入mac获取X、S的mac地址：M、N                                                                                                                                                                  |
|              | 2.新设备S在console中whitelist add M（不要加符号）；节点X在console中whitelist add N（不要加符号）                                                                                                                             |
|              | 3.在节点X和新设备S的console中输入whitelist enable                                                                                                                                                                            |
| 预期结果     | 步骤3：新加入的设备会挂在节点X下面，在节点Ｘ的console输入umesh nbrs，可以看到新加入的设备                                                                                                                                    |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） **功能暂无，后期添加完善** |

### 白名单—白名单为空时enable白名单会消息闭塞

| 测试用例编号 | AOS-2-36                                                                                                                                                                                                                     |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—白名单为空时enable白名单会消息闭塞                                                                                                                                                                                    |
| 测试目的     | 验证enable空白名单后，侦听不到任何消息                                                                                                                                                                                       |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                     |
| 测试拓扑图   | 1.当前周边已有且只有一个构建的mesh网络                                                                                                                                                                                       |
|              | 2.当前mesh网络中有一个leader节点和一个router节点                                                                                                                                                                             |
| 测试预置条件 | 同上                                                                                                                                                                                                                         |
| 测试步骤     | 1.在router节点A上的console中输入whitelist enable（白名单里面为空） 2.在其他节点上广播：ping 224.0.0.252（ipv4地址）或者ping ff08:0:0:fffe:0:0:0:fc（ipv6地址） 3.节点A上输入whitelist disable，等2分钟                       |
| 预期结果     | 步骤1：等待一段时间后，节点A会成为leader 步骤2：无法收到A节点的回复打印 步骤3：节点A会恢复成之前的router                                                                                                                     |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） **功能暂无，后期添加完善** |

### 白名单—白名单不为空时enable白名单会收到消息

| 测试用例编号 | AOS-2-37                                                                                                                                                                                                                     |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—白名单不为空时enable白名单会收到消息                                                                                                                                                                                  |
| 测试目的     | 验证白名单不为空时enable白名单后广播能否收到                                                                                                                                                                                 |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                     |
| 测试拓扑结构 | 1.有且只有一个mesh网络 2.一个leader和2个（或者3个）router                                                                                                                                                                    |
| 测试预置条件 | 同上                                                                                                                                                                                                                         |
| 测试步骤     | 1.A与B互加白名单 2.在其他节点上（非A，B节点）广播 3.节点B上输入whitelist disable，等2分钟 4.节点A上输入sids，leader节点下输入sids                                                                                            |
| 预期结果     | 步骤1：节点B会成为节点A的子节点 步骤2：能收到B节点的回复打印 步骤3：节点B不会挂在A下面，直接挂在leader下面                                                                                                                   |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） **功能暂无，后期添加完善** |

### 白名单—将leader加入白名单后可侦听到广播

| 测试用例编号 | AOS-2-38                                                                                                                                                                                                                     |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—将leader加入白名单后可侦听到广播                                                                                                                                                                                      |
| 测试目的     | 验证将leader加入白名单后是否可侦听到广播                                                                                                                                                                                     |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                     |
| 测试拓扑结构 | 1.有且只有一个mesh网络 2.一个leader和2个（或者3个）router                                                                                                                                                                    |
| 测试预置条件 | 同上                                                                                                                                                                                                                         |
| 测试步骤     | 1.在leader节点上输入macaddr获取mac地址 M 2.在router节点X上输入whitelist enable（白名单里面为空），再                                                                                                                         |
|              | 输入whitelist add M （不要加符号）                                                                                                                                                                                           |
|              | 3.在其它节点上（非X和leader节点）广播                                                                                                                                                                                        |
| 预期结果     | 步骤2：节点x会成为该leader的子节点 步骤3：X能听到消息                                                                                                                                                                        |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） **功能暂无，后期添加完善** |

### 白名单—关闭白名单功能拓扑结构会相应改变

| 测试用例编号 | AOS-2-39                                                                                                                                                                                                                            |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 白名单—关闭白名单功能拓扑结构会相应改变                                                                                                                                                                                             |
| 测试目的     | 验证将白名单功能关闭后是否会改变拓扑结构                                                                                                                                                                                            |
| 测试属性     | 必选\| P3 \| 功能用例                                                                                                                                                                                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                            |
| 测试拓扑结构 | 1.有且只有一个mesh网络 2.1个leader+多个router                                                                                                                                                                                       |
| 测试预置条件 | 同上                                                                                                                                                                                                                                |
| 测试步骤     | 1.在节点A上输入whitelist enable（白名单里面为空） 2.在A的console中输入 whitelist disable 3.在A的console中输入whitelist enable，再输入whitelist add M （不要加符号，M为节点B的mac地址） 4.在A的console中输入 whitelist disable       |
| 预期结果     | 步骤1：等待2分钟后，节点A会成为leader 步骤2：等待2分钟后，节点A会成为router 步骤3：等待2分钟后，A成为B的子节点，B的console中输入umesh nbrs，可以看到A 步骤4：等待2分钟后，A不再是B的子节点，B的console中输入umesh nbrs，可以看不到A |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无） 保险起见输入完whitelist enable后，都需要重启mesh，即umesh stop再umesh start（此结论待定） 白名单功能只是辅助测试的工具，用于搭建复杂网络（即多跳节点） **功能暂无，后期添加完善**        |

### 802.15.4组网—mac查看

| 测试用例编号 | AOS-2-40                                                                                                                                                                                                                                                                         |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 802.15.4组网—mac查看                                                                                                                                                                                                                                                             |
| 测试目的     | 查看设备mac地址                                                                                                                                                                                                                                                                  |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                            |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC ，4. CC2520 802.15.4模组，5.串口线                                                                                                                                                                                                                |
| 测试拓扑结构 | leader+router                                                                                                                                                                                                                                                                    |
| 测试预置条件 | CC2520 802.15.4模组正确连接上ESP32模组 设备上电，在ysh中输入test conf yoc.cmdline --mesh-interface,4（这个命令用于使能设备使用802.15.4组网，若是想要是设备使用WiFi，则在ysh中输入命令test conf yoc.cmdline --mesh-interface,1） 重启设备，在ysh中输入ur，init，start进入mesh环境 |
| 测试步骤     | 1.在某节点的console中输入macaddr                                                                                                                                                                                                                                                 |
| 预期结果     | 步骤1：3f:58:00:00:00:00:00:00                                                                                                                                                                                                                                                   |
| 备注         | 802.15.4只有macaddr和WiFi不同，其他的都一样 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                                           |

### 802.15.4组网—功能测试

| 测试用例编号 | AOS-2-41                                                                                                                                                                                                                                                                               |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 802.15.4组网—功能测试                                                                                                                                                                                                                                                                  |
| 测试目的     | 验证802.15.4组网下的各项功能是否正常                                                                                                                                                                                                                                                   |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                                  |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4. CC2520 802.15.4模组，5.串口线                                                                                                                                                                                                                          |
| 测试拓扑结构 | leader+router                                                                                                                                                                                                                                                                          |
| 测试预置条件 | 1.CC2520 802.15.4模组正确连接上ESP32模组 2.设备上电，在ysh中输入test conf yoc.cmdline --mesh-interface,4（这个命令用于使能设备使用802.15.4组网，若是想要是设备使用WiFi，则在ysh中输入命令test conf yoc.cmdline --mesh-interface,1） 3.重启设备，在ysh中输入ur，init，start进入mesh环境 |
| 测试步骤     | 1.802.11上的基础功能均测试一遍                                                                                                                                                                                                                                                         |
| 预期结果     | 步骤1：所有结果均pass                                                                                                                                                                                                                                                                  |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                                                                                             |

### AP断网—mesh网络中AP断网不会影响网络

| 测试用例编号 | AOS-2-42                                                                                                                                                     |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | AP断网—mesh网络中AP断网不会影响网络                                                                                                                          |
| 测试目的     | 验证mesh网络中AP断网是否会影响网络                                                                                                                           |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                     |
| 测试拓扑结构 | 1.设备配网成功 2.mesh网络的拓扑结构Leader+3router                                                                                                            |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                   |
| 测试步骤     | 1. 断开AP的网络 2. 查看各个节点的netid 3. 节点之间相互ping 4. 节点发送广播 5. 连上AP网络                                                                     |
| 预期结果     | 步骤2：mesh环境存在，所有节点的netid相同且较断开AP前没有改变 步骤3：节点之间能够相互ping通 步骤4：节点都能收到广播消息 步骤5：拓扑结构不变，节点间相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                   |

### AP断电—路由器AP断电后5分钟内上电mesh网络正常

| 测试用例编号 | AOS-2-43                                                          |
|--------------|-------------------------------------------------------------------|
| 测试用例     | AP断电—路由器AP断电后5分钟内上电mesh网络正常                      |
| 测试目的     | 验证路由器AP断电后5分钟内上电mesh网络正常                         |
| 测试属性     | 必选\| P0 \| 功能用例                                             |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                          |
| 测试拓扑结构 | 1.设备配网成功 2.mesh网络的拓扑结构Leader+3router                 |
| 测试预置条件 | 同上                                                              |
| 测试步骤     | 1.路由器断电 2.5分钟后路由器上电，等待5分钟                       |
| 预期结果     | 步骤2：设备能连上网络，且mesh网络存在，节点A ping 节点B能够ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                        |

### 路由器级联拓扑—断开级联路由器电源后mesh网络存在并能进行通信

| 测试用例编号 | AOS-2-44                                                                                                                                                                                            |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 路由器级联拓扑—断开级联路由器电源后mesh网络存在并能进行通信                                                                                                                                         |
| 测试目的     | 验证断开级联路由器电源后mesh网络存在并能进行通信                                                                                                                                                    |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                            |
| 测试拓扑结构 | 1.两个路由器级联，A连外网，B级联A，A和B均设置成相同的SSID，PW和channel 2.所有设备均成功配网至级联网络 3.设备的拓扑模式Leader+3router                                                                |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                                          |
| 测试步骤     | 1.断开路由器B电源 2.插上路由器B电源 3.断开路由器A电源 4.插上路由器A电源                                                                                                                             |
| 预期结果     | 步骤1：所有设备会先断网一会，然后自动联网成功，此时mesh环境存在，设备之间也能相互ping通 步骤2：mesh环境存在，设备之间也能相互ping通 步骤3：mesh环境存在 步骤4：mesh环境存在，设备之间也能相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                          |

### WDS环境—断开副路由器电源后mesh网络存在并能进行通信

| 测试用例编号 | AOS-2-45                                                                                                                                                                                            |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | WDS环境—断开副路由器电源后mesh网络存在并能进行通信                                                                                                                                                  |
| 测试目的     | 验证断开副路由器电源后mesh网络存在并能进行通信                                                                                                                                                      |
| 测试属性     | 必选\| P2 \| 功能用例                                                                                                                                                                               |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                            |
| 测试拓扑结构 | 1.两个路由器级联，A连外网，B级联A，A和B均设置成相同的SSID，PW和channel，两个路由器通过WDS连接 2.所有设备均成功配网至级联网络B 3.设备的拓扑模式Leader+3router                                        |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                                          |
| 测试步骤     | 1.断开路由器B电源 2.插上路由器B电源 3.断开路由器A电源 4.插上路由器A电源                                                                                                                             |
| 预期结果     | 步骤1：所有设备会先断网一会，然后自动联网成功，此时mesh环境存在，设备之间也能相互ping通 步骤2：mesh环境存在，设备之间也能相互ping通 步骤3：mesh环境存在 步骤4：mesh环境存在，设备之间也能相互ping通 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                          |

### Alink_umesh gateway服务

| 测试用例编号 | AOS-2-46                                                                                                                                                                                                                                                                                                                                                                               |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | Alink_umesh gateway服务                                                                                                                                                                                                                                                                                                                                                                |
| 测试目的     | 验证gateway为mesh节点提供上云服务                                                                                                                                                                                                                                                                                                                                                      |
| 测试属性     | 必选\| P0 \| 功能用例                                                                                                                                                                                                                                                                                                                                                                  |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                                                                                                                                                                                                               |
| 测试拓扑结构 | 1.设备的拓扑模式Leader+3router                                                                                                                                                                                                                                                                                                                                                         |
| 测试预置条件 | 1.手机下载厂测包 2.按上面拓扑结构搭建环境                                                                                                                                                                                                                                                                                                                                              |
| 测试步骤     | 1.起leader设备A,连接AP，成功连上alink，获取设备的UUID，绑定激活成功 2.APP端查看设备A在线 3.起子节点设备，不连接AP，等待几分钟 4. APP端进入认证---新建测试认证---选择A设备，点击进入 5.在某个子设备B的console端执行gateway login，在APP端选择子设备B，下一步---选择性能测试---选择2pps，点击执行 6.点击停止，重启leader设备（或者stop再start），重复步骤5 7.重启B（或者stop 再start B） |
| 预期结果     | 步骤3：拓扑结构形成 步骤4：子设备全部显示出来 步骤5：设备A和B都会出现云端下发消息的打印 步骤6：设备A和B都会出现云端下发消息的打印 步骤7：设备A和B都会出现云端下发消息的打印                                                                                                                                                                                                            |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                                                                                                                                                                                                                                                             |

### 性能测试—低频指令压测（2pps）

| 测试用例编号 | AOS-2-47                                                                                                       |
|--------------|----------------------------------------------------------------------------------------------------------------|
| 测试用例     | 性能测试—低频指令压测（2pps）                                                                                  |
| 测试目的     | 验证子节点与父节点通信响应低频业务指令处理能力                                                                 |
| 测试属性     | 必选\| P0 \| 性能用例                                                                                          |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                       |
| 测试拓扑结构 | Leader配网绑定成功，拓扑结构随意（例如：leader+4router） 【0x0（连接AP）+0x1000+0x2000+0x2100+0x3000】         |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                     |
| 测试步骤     | 1.对拓扑的2级子节点（例如：0x2100）进行2pps的测试                                                              |
| 预期结果     | APP端测试结果显示pass，且拓扑结构没有变化，节点间也能相互ping通                                                |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则换成1级子节点测试（0x2000） 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 长时间测试—节点间长时间ping仍能通信

| 测试用例编号 | AOS-2-48                                                                                                                                |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—节点间长时间ping仍能通信                                                                                                     |
| 测试目的     | 验证节点间长时间ping后仍能通信                                                                                                          |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                   |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                |
| 测试拓扑结构 | 1.有且只有一个mesh网络 2.设备的拓扑模式Leader+3router                                                                                   |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                              |
| 测试步骤     | 1.节点A和节点B ping 12h 2.所有节点相互ping 3.所有节点广播一下                                                                           |
| 预期结果     | 步骤1：mesh环境存在，所有节点console输入umesh status，网络netid没变且一致 步骤2：设备之间也能相互ping通 步骤3：所有节点均能收到广播消息 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                              |

### 长时间测试—AP连续断电上电一晚上后mesh网络存在

| 测试用例编号 | AOS-2-49                                                                                                                                       |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP连续断电上电一晚上后mesh网络存在                                                                                                  |
| 测试目的     | 验证AP连续断电上电一晚上后mesh网络存在                                                                                                         |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                          |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                       |
| 测试拓扑结构 | 1.leader连接AP，其它节点不连接AP 2.设备的拓扑模式Leader+3router                                                                                |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                     |
| 测试步骤     | 1.所有设备都上电，且都处于mesh环境中 2.将AP电源反复断开连接持续12h后，AP电源上电 3.等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 步骤3：设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                                 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                     |

### 长时间测试—AP长时间断电再上电后mesh网络存在

| 测试用例编号 | AOS-2-50                                                                                                                                           |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP长时间断电再上电后mesh网络存在                                                                                                        |
| 测试目的     | 验证AP长时间断电再上电后mesh网络存在                                                                                                               |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                           |
| 测试拓扑结构 | 1.leader连接AP，其它节点不连接AP 2.设备的拓扑模式Leader+3router                                                                                    |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                         |
| 测试步骤     | 1.所有设备都上电，且都处于同一个mesh环境中 2.将AP电源长时间断开12h后，再给AP电源上电 3.等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 步骤3：设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                                     |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                         |

### 长时间测试—AP连续断网再连网一晚上后mesh网络存在

| 测试用例编号 | AOS-2-51                                                                                                                                       |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP连续断网再连网一晚上后mesh网络存在                                                                                                |
| 测试目的     | 验证AP连续断网再连网一晚上后mesh网络存在                                                                                                       |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                          |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                       |
| 测试拓扑结构 | 1.leader连接AP，其它节点不连接AP 2.设备的拓扑模式Leader+3router                                                                                |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                     |
| 测试步骤     | 1.所有设备都上电，且都处于mesh环境中 2.将AP网络反复断开连接持续12h后，AP连接网络 3.等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 步骤3：设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                                 |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                     |

### 长时间测试—AP长时间断网再连网后mesh网络存在

| 测试用例编号 | AOS-2-52                                                                                                                                     |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 长时间测试—AP长时间断网再连网后mesh网络存在                                                                                                  |
| 测试目的     | 验证AP长时间断网再连网后mesh网络存在                                                                                                         |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                        |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                     |
| 测试拓扑结构 | 1.leader连接AP，其它节点不连接AP 2.设备的拓扑模式Leader+3router                                                                              |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                   |
| 测试步骤     | 1.所有设备都上电，且都处于mesh环境中 2.将AP网络长时间断开12h后，再给AP连接网络 3.等待一段时间后， 查看所有设备的channel，netid，netsize和sid |
| 预期结果     | 步骤3：设备的channel， netid，netsize是一致，sid也没有冲突，节点间能相互ping通                                                               |
| 备注         | 802.15.4组网、BLE组网（此2种组网功能暂无）                                                                                                   |

### 稳定性测试—5\*24小时长时间挂机测试

| 测试用例编号 | AOS-2-53                                                                                                                             |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 稳定性测试—5\*24小时长时间挂机测试                                                                                                   |
| 测试目的     | 验证设备的mesh运行5\*24小时仍然正常工作                                                                                              |
| 测试属性     | 必选\| P0 \| 稳定性用例                                                                                                              |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                             |
| 测试拓扑结构 | 设备配网成功，且形成了mesh网络，拓扑结构随意（例如：leader+6router） 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】     |
| 测试预置条件 | 同上                                                                                                                                 |
| 测试步骤     | 1.所有设备形成的mesh网络放置5\*24小时                                                                                                |
| 预期结果     | Mesh网络仍然存在，没有设备重启，crash，掉线等。设备间能够ping通                                                                      |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—各节点间能相互ping通

| 测试用例编号 | AOS-2-54                                                                                                                                                          |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—各节点间能相互ping通                                                                                                                                     |
| 测试目的     | 验证网络中的各节点间是否能相互ping通                                                                                                                              |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                             |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                          |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                                                 |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                        |
| 测试步骤     | 所有节点相互ping各自的IP地址【例：ping 10.0.16.2（ipv4地址）或者ping fc00:0:0:6800:0:10（ipv6地址）                                                               |
| 预期结果     | 所有节点间都能ping通，能收到对应节点回复打印                                                                                                                      |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持 802.15.4组网、BLE组网（此2种组网功能暂无） **目前暂只支持ipv4地址网络** |

### 复杂组网—各节点间能相互ping长字节

| 测试用例编号 | AOS-2-55                                                                                                                                                          |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—各节点间能相互ping长字节                                                                                                                                 |
| 测试目的     | 验证网络中的各节点间是否能相互ping通长字节                                                                                                                        |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                             |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                          |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                                                 |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                        |
| 测试步骤     | 所有节点相互长字节ping各自的IP地址【例：ping 10.0.16.2 1000（ipv4地址）或者 ping fc00:0:0:6800:0:1000 1000（ipv6地址）】                                          |
| 预期结果     | 所有节点间都能ping通，能收到对应节点回复打印                                                                                                                      |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持 802.15.4组网、BLE组网（此2种组网功能暂无） **目前暂只支持ipv4地址网络** |

### 复杂组网—ping全网广播

| 测试用例编号 | AOS-2-56                                                                                                                                                                                       |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—ping全网广播                                                                                                                                                                          |
| 测试目的     | 验证网络中的ping全网广播后所有节点是否都收到                                                                                                                                                   |
| 测试属性     | 必选\| P1 \| 功能用例                                                                                                                                                                          |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                                                                                       |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                                                                              |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                                                                                     |
| 测试步骤     | 1.每个节点上分别执行ping 224.0.0.252 2.每个节点上执行指定长度的广播，执行命令是ping 224.0.0.252 X（ipv4地址）或者ping ff08:0:0:fffe:0:0:0:fc X（ipv6地址）                                     |
| 预期结果     | 步骤1：能够正常ping通，能收到所有节点回复打印 步骤2：能够正常ping通，能收到所有节点回复打印。                                                                                                  |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持、 X为字节长度，范围在1\~1492 802.15.4组网、BLE组网（此2种组网功能暂无） **目前暂只支持ipv4地址网络** |

### 复杂组网—AP断网再联网，mesh网络保持不变

| 测试用例编号 | AOS-2-57                                                                                                                             |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—AP断网再联网，mesh网络保持不变                                                                                              |
| 测试目的     | 验证断网后再联网，mesh网络是否变化                                                                                                   |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                |
| 测试设备     | 1.终端设备，2.串口线，3.无线路由器，4.PC                                                                                             |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                    |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                           |
| 测试步骤     | 1.AP断网后再联网                                                                                                                     |
| 预期结果     | 步骤1：等待5分钟后mesh网络的拓扑结构不变，设备能响应APP的下行操作，节点间能够相互通信                                                |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—AP断电再上电，mesh网络保持不变

| 测试用例编号 | AOS-2-58                                                                                                                             |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—AP断电再上电，mesh网络保持不变                                                                                              |
| 测试目的     | 验证AP断电再上电，mesh网络是否变化                                                                                                   |
| 测试属性     | 必选\| P1 \| 性能用例                                                                                                                |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4.手机                                                                                                  |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                    |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                           |
| 测试步骤     | 1.AP断电后再上电                                                                                                                     |
| 预期结果     | 步骤1：等待8分钟后mesh网络的拓扑结构不变，设备能响应APP的下行操作，节点间能够相互通信                                                |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—12H长时间AP断网后再联网，mesh网络保持不变

| 测试用例编号 | AOS-2-59                                                                                                                             |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—12H长时间AP断网后再联网，mesh网络保持不变                                                                                   |
| 测试目的     | 验证12H长时间断网后再联网，mesh网络是否变化                                                                                          |
| 测试属性     | 必选\| P1 \| 稳定性用例                                                                                                              |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4.手机                                                                                                  |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                    |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                           |
| 测试步骤     | 1.AP断网12H后再联网                                                                                                                  |
| 预期结果     | 步骤1：等待5分钟后mesh网络的拓扑结构不变，设备能响应APP操作，节点间能够相互通信                                                      |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持 802.15.4组网、BLE组网（此2种组网功能暂无） |

### 复杂组网—12H长时间AP断电后再上电，mesh网络保持不变

| 测试用例编号 | AOS-2-60                                                                                                                             |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 复杂组网—12H长时间AP断电后再上电，mesh网络保持不变                                                                                   |
| 测试目的     | 验证AP断电12H再上电，mesh网络是否变化                                                                                                |
| 测试属性     | 必选\| P1 \| 稳定性用例                                                                                                              |
| 测试设备     | 1.设备，2.无线路由器，3.PC ，4.手机                                                                                                  |
| 测试拓扑结构 | 所有设备组成一个mesh网络（leader+6router），请见附录B 【0x0（连接AP）+0x1000+0x2000+0x2100+0x2110+0x2200+0x3000】                    |
| 测试预置条件 | 按照上面的拓扑结构搭建环境                                                                                                           |
| 测试步骤     | 1.AP断网后12H再联网                                                                                                                  |
| 预期结果     | 步骤1：等待8分钟后mesh网络的拓扑结构不变，设备能响应APP操作，节点间能够相互通信                                                      |
| 备注         | 此项搭建多级子节点上测试，如无此环境，则6个router均为1级子节点 多级跳节点需要白名单来支持 802.15.4组网、BLE组网（此2种组网功能暂无） |

AliOS Things 通道测试
=====================

Alink
-----

### 设备注册与登录

| 测试用例编号 | AOS-3-1                              |
|--------------|--------------------------------------|
| 测试用例     | 设备注册与登录                       |
| 测试目的     | 验证设备是否支持注册、登录逻辑       |
| 测试属性     | 必选 \| P0 \| 功能用例               |
| 测试设备     | 1.设备，2.串口线，3.PC               |
| 测试拓扑结构 | 一个设备串口连接PC                   |
| 测试预置条件 | 设备联网                             |
| 测试步骤     | 设备注册、登录成功并保持在线状态     |
| 预期结果     | 注册成功、登录成功                   |
| 备注         | alink1.0 注册接口： registerDevice； |

1.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

>   alink1.1 注册接口： device.registerByAuthToken。

1.  alink1.0 登录接口： LoginDevice；

>   alink1.1 登录接口： device.login

### 设备UUID持久化

| 测试用例编号 | AOS-3-2                                                      |
|--------------|--------------------------------------------------------------|
| 测试用例     | 设备UUID持久化                                               |
| 测试目的     | 验证设备注册后持久化存储UUID，在断开连接、上电重启后不再注册 |
| 测试属性     | 必选 \| P0 \| 功能用例                                       |
| 测试设备     | 1.设备，2.串口线，3.PC                                       |
| 测试拓扑结构 | 一个设备串口连接PC                                           |
| 测试预置条件 | 设备联网                                                     |
| 测试步骤     | 设备连接，并保持在线状态                                     |
| 预期结果     | 断网后设备连线重连不出现注册行为                             |
| 备注         |                                                              |

1.  断开网络使设备离线

2.  恢复网络使设备上线

3.  设备掉电重启，网络保持正常使设备上线

4.  设备掉电重启后不出现注册行为

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备响应下行命令及上报状态

| 测试用例编号 | AOS-3-3                                                 |
|--------------|---------------------------------------------------------|
| 测试用例     | 设备响应下行命令及上报状态                              |
| 测试目的     | 验证设备是否能正常响应云平台的下行命令， 并上报设备状态 |
| 测试属性     | 必选 \| P0 \| 功能用例                                  |
| 测试设备     | 1.设备，2.串口线，3.PC                                  |
| 测试拓扑结构 | 一个设备串口连接PC                                      |
| 测试预置条件 | 设备联网                                                |
| 测试步骤     | 设备连接，并保持在线状态                                |
| 预期结果     | 设备正确上报状态                                        |
| 备注         |                                                         |

1.  设备模拟上报数据

2.  通过APP或者web下行控制设备命令

3.  设备正确响应下行命令

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备主动上报状态

| 测试用例编号 | AOS-3-4                                                                  |
|--------------|--------------------------------------------------------------------------|
| 测试用例     | 设备主动上报状态                                                         |
| 测试目的     | 验证设备是否支持主动上报设备状态，上电后第一次上报是否支持上报完整的状态 |
| 测试属性     | 必选 \| P0 \| 功能用例                                                   |
| 测试设备     | 1.设备，2.串口线，3.PC                                                   |
| 测试拓扑结构 | 一个设备串口连接PC                                                       |
| 测试预置条件 | 设备联网                                                                 |
| 测试步骤     | 设备上电等待连接成功后，查看设备上报数据                                 |
| 预期结果     | 步骤1\~3设备上报所有属性值                                               |
| 备注         |                                                                          |

1.  断网后恢复连接后，查看设备上报数据

2.  重新联网后，查看设备上报数据

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备恢复出厂设置

| 测试用例编号 | AOS-3-5                                  |
|--------------|------------------------------------------|
| 测试用例     | 设备恢复出厂设置                         |
| 测试目的     | 设备原厂恢复功能                         |
| 测试属性     | 可选 \| P0 \| 功能用例                   |
| 测试设备     | 1.设备，2.串口线，3.PC                   |
| 测试拓扑结构 | 一个设备串口连接PC                       |
| 测试预置条件 | 设备联网                                 |
| 测试步骤     | 设备上电，连接成功并保持心跳             |
| 预期结果     | 设备恢复出厂设置，账号与设备绑定关系解除 |
| 备注         |                                          |

1.  对设备进行硬件或软件恢复出厂设置

2.  设备上电重连，查看设备与账号绑定关系

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备透传

| 测试用例编号 | AOS-3-6                                        |
|--------------|------------------------------------------------|
| 测试用例     | 设备透传                                       |
| 测试目的     | 验证设备是否支持指令透传模式                   |
| 测试属性     | 可选 \| P0 \| 功能用例                         |
| 测试设备     | 1.设备，2.串口线，3.PC                         |
| 测试拓扑结构 | 一个设备串口连接PC                             |
| 测试预置条件 | 设备联网                                       |
| 测试步骤     | 设备上电，连接成功并保持心跳                   |
| 预期结果     | 设备成功上报二进制数据也能接收到接收到模拟数据 |
| 备注         |                                                |

1.  设备模拟上报二进制数据

2.  APP或web模拟发送数据到设备端

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备上报状态时延

| 测试用例编号 | AOS-3-7                                                                                                                                   |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 设备上报状态时延                                                                                                                          |
| 测试目的     | 验证设备功能或状态发生改变时，及时上报变更后的属性数据到服务 端，如：用户通过 APP 调节空调温度，调节成功后，温度值应该即时 上报到服务端。 |
| 测试属性     | 必选 \| P0 \| 功能用例                                                                                                                    |
| 测试设备     | 1.设备，2.串口线，3.PC                                                                                                                    |
| 测试拓扑结构 | 一个设备串口连接PC                                                                                                                        |
| 测试预置条件 | 设备联网                                                                                                                                  |
| 测试步骤     | 设备上电，连接成功并保持心跳                                                                                                              |
| 预期结果     | 设备从收到控制指令到上报属性到服务端时延≤1s                                                                                               |
| 备注         |                                                                                                                                           |

1.  通过APP下发控制命令改变设备属性值，查看
    log，确认设备从收到控制指令到上报该属性到服务端时长

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 低频指令测试

| 测试用例编号 | AOS-3-8                                 |
|--------------|-----------------------------------------|
| 测试用例     | 低频指令测试                            |
| 测试目的     | 验证设备低频通信稳定性                  |
| 测试属性     | 必选 \| P0 \| 稳定性用例                |
| 测试设备     | 1.设备，2.串口线，3.PC                  |
| 测试拓扑结构 | 一个设备串口连接PC                      |
| 测试预置条件 | 设备联网                                |
| 测试步骤     | 设备连接，并保持在线状态                |
| 预期结果     | 12小时稳定工作，无断线                  |
| 备注         | 压测工具及使用见 “AliOS Things认证指南” |

1.  使用压测工具以500ms为周期向设备发送消息

2.  指令响应成功率≥99.9%

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 高频指令测试

| 测试用例编号 | AOS-3-9                                 |
|--------------|-----------------------------------------|
| 测试用例     | 高频指令测试                            |
| 测试目的     | 验证设备高频通信稳定性                  |
| 测试属性     | 可选 \| P0 \| 稳定性用例                |
| 测试设备     | 1.设备，2.串口线，3.PC                  |
| 测试拓扑结构 | 一个设备串口连接PC                      |
| 测试预置条件 | 设备联网                                |
| 测试步骤     | 设备连接，并保持在线状态                |
| 预期结果     | 12小时稳定工作，无断线                  |
| 备注         | 压测工具及使用见 “AliOS Things认证指南” |

1.  使用压测工具以200ms为周期向设备发送消息

2.  指令响应成功率≥98%

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 长时间稳定工作

| 测试用例编号 | AOS-3-10                                |
|--------------|-----------------------------------------|
| 测试用例     | 长时间稳定工作                          |
| 测试目的     | 验证设备ALink长时间稳定工作             |
| 测试属性     | 必选 \| P0 \| 稳定性用例                |
| 测试设备     | 1.设备，2.串口线，3.PC                  |
| 测试拓扑结构 | 一个设备串口连接PC                      |
| 测试预置条件 | 设备联网                                |
| 测试步骤     | 设备认证连接，在线保持心跳              |
| 预期结果     | 5x24小时稳定工作                        |
| 备注         | 压测工具及使用见 “AliOS Things认证指南” |

1.  离线次数＜4次

2.  单次离线时间≤60秒

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 长时间断网后恢复连接能力

| 测试用例编号 | AOS-3-11                                    |
|--------------|---------------------------------------------|
| 测试用例     | 长时间断网后恢复连接能力                    |
| 测试目的     | 验证设备ALink长时间断网后自动恢复连接的能力 |
| 测试属性     | 必选 \| P0 \| 稳定性用例                    |
| 测试设备     | 1.设备，2.串口线，3.PC                      |
| 测试拓扑结构 | 一个设备串口连接PC                          |
| 测试预置条件 | 设备联网                                    |
| 测试步骤     | 设备认证连接，在线保持心跳                  |
| 预期结果     | 检测到网络断开                              |
| 备注         |                                             |

1.  稳定后断开网络连接（AP断电）

2.  12小时后AP上电

3.  网络恢复后自动恢复连接能力

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 长时间断网后恢复业务能力

| 测试用例编号 | AOS-3-12                                    |
|--------------|---------------------------------------------|
| 测试用例     | 长时间断网后恢复业务能力                    |
| 测试目的     | 验证设备ALink长时间断网后自动恢复连接的能力 |
| 测试属性     | 必选 \| P0 \| 稳定性用例                    |
| 测试设备     | 1.设备，2.串口线，3.PC                      |
| 测试拓扑结构 | 一个设备串口连接PC                          |
| 测试预置条件 | 设备联网                                    |
| 测试步骤     | 设备认证连接，在线保持心跳                  |
| 预期结果     | 检测到网络断开                              |
| 备注         |                                             |

1.  稳定后断开网络连接（断开AP端WAN网络）

2.  12小时后后恢复网络（连接AP端WAN网络）

3.  恢复连接后使用在线工具下发数据包

4.  网络恢复后自动恢复连接能力

5.  网络恢复后能正常收发数据包

6.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 支持无缝切换AP能力

| 测试用例编号 | AOS-3-13                                                   |
|--------------|------------------------------------------------------------|
| 测试用例     | 支持无缝切换AP能力                                         |
| 测试目的     | 验证更改AP后，在SSID与无线密码不变的情况，自动恢复连接能力 |
| 测试属性     | 必选 \| P1 \| 功能用例                                     |
| 测试设备     | 1.设备，2.串口线，3.PC                                     |
| 测试拓扑结构 | 一个设备串口连接PC                                         |
| 测试预置条件 | 设备联网                                                   |
| 测试步骤     | 手机连接AP1网络，联网设备，此时设备连接到AP1               |
| 预期结果     | 检测到网络断开                                             |
| 备注         |                                                            |

1.  关闭AP1电源，此时设备出现断网状态，然后接通AP2（无线SSID与无线密钥，与AP1保持一致）电源

2.  设备连接到AP2并重连保持在线状态

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 超长数据包接收处理能力

| 测试用例编号 | AOS-3-14                                                          |
|--------------|-------------------------------------------------------------------|
| 测试用例     | 超长数据包接收处理能力                                            |
| 测试目的     | 验证更改AP后，在SSID与无线密码不变的情况，自动恢复连接能力        |
| 测试属性     | 必选 \| P1 \| 功能用例                                            |
| 测试设备     | 1.设备，2.串口线，3.PC                                            |
| 测试拓扑结构 | 一个设备串口连接PC                                                |
| 测试预置条件 | 设备联网并连接物联平台                                            |
| 测试步骤     | 模拟APP发送有效业务数据包(payload≥2000字节，连续发送10个)到设备端 |
| 预期结果     | 系统成功接收并处理2000字节或者1000字节                            |
| 备注         |                                                                   |

1.  模拟APP发送有效业务数据包（payload=1000字节），设备端响应成功、主动上报状态。

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备上电到联网成功时长

| 测试用例编号 | AOS-3-15                                                               |
|--------------|------------------------------------------------------------------------|
| 测试用例     | 设备上电到联网成功时长                                                 |
| 测试目的     | 验证设备从上电启动，到连接物联平台所耗时长，启动时间长短影响用户体验。 |
| 测试属性     | 必选 \| P1 \| 功能用例                                                 |
| 测试设备     | 1.设备，2.串口线，3.PC                                                 |
| 测试拓扑结构 | 一个设备串口连接PC，设备连接AP                                         |
| 测试预置条件 | 设备联网并连接物联平台                                                 |
| 测试步骤     | 切断设备电源，再接通电源开始计时为A；                                  |
| 预期结果     | B-A≤15秒                                                               |
| 备注         |                                                                        |

1.  确认设备重启并成功连接物联平台的时间为B

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

MQTT
----

### 设备认证

| 测试用例编号 | AOS-3-16                                                                |
|--------------|-------------------------------------------------------------------------|
| 测试用例     | 设备认证                                                                |
| 测试目的     | 验证设备认证后获取iotid与iottoken                                       |
| 测试属性     | 必选 \| P0 \| 功能用例                                                  |
| 测试设备     | 1.设备，2.串口线，3.PC                                                  |
| 测试拓扑结构 | 一个设备串口连接PC                                                      |
| 测试预置条件 | 设备联网成功                                                            |
| 测试步骤     | 设备尝试通过HTTPS/MQTT/ID2认证                                          |
| 预期结果     | 设备所支持的认证方式认证通过，拿到iotid和iottoken并且成功连接MQTT服务器 |
| 备注         | 认证方式有HTTPS认证/MQTT直连认证/ID2认证，设备可选支持其中一种或多种    |

### MQTT通道连接

| 测试用例编号 | AOS-3-17                               |
|--------------|----------------------------------------|
| 测试用例     | MQTT通道连接                           |
| 测试目的     | 验证设备连接MQTT服务器                 |
| 测试属性     | 必选 \| P0 \| 功能用例                 |
| 测试设备     | 1.设备，2.串口线，3.PC                 |
| 测试拓扑结构 | 一个设备串口连接PC                     |
| 测试预置条件 | 设备联网成功                           |
| 测试步骤     | 设备连接设备MQTT服务器                 |
| 预期结果     | 设备连接MQTT服务成功，设备状态变为在线 |
| 备注         |                                        |

1.  设备认证通过并获得iotid与iottoken

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备订阅topic

| 测试用例编号 | AOS-3-18                                                    |
|--------------|-------------------------------------------------------------|
| 测试用例     | 设备订阅topic                                               |
| 测试目的     | 验证设备连接成功后订阅topic的能力                           |
| 测试属性     | 必选 \| P0 \| 功能用例                                      |
| 测试设备     | 1.设备，2.串口线，3.PC                                      |
| 测试拓扑结构 | 一个设备串口连接PC                                          |
| 测试预置条件 | 设备联网                                                    |
| 测试步骤     | 设备订阅topic A，保持在线状态                               |
| 预期结果     | 设备接收到topic A的一条消息并且消息内容与页面填写的内容相同 |
| 备注         |                                                             |

1.  设备认证通过并连接至MQTT服务器

2.  web页面向该设备的topic A 发布一条消息

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备发布topic

| 测试用例编号 | AOS-3-19                                                         |
|--------------|------------------------------------------------------------------|
| 测试用例     | 设备发布topic                                                    |
| 测试目的     | 验证设备连接成功后主动发布topic的能力                            |
| 测试属性     | 必选 \| P0 \| 功能用例                                           |
| 测试设备     | 1.设备，2.串口线，3.PC                                           |
| 测试拓扑结构 | 一个设备串口连接PC                                               |
| 测试预置条件 | 设备联网                                                         |
| 测试步骤     | 设备向topic A发布一条消息                                        |
| 预期结果     | 设备发布消息成功，服务日志查询的消息内容与设备发布的消息内容相同 |
| 备注         |                                                                  |

1.  设备认证通过并连接至MQTT服务器

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备取消订阅topic

| 测试用例编号 | AOS-3-20                        |
|--------------|---------------------------------|
| 测试用例     | 设备取消订阅topic               |
| 测试目的     | 验证设备取消订阅topic后通信正常 |
| 测试属性     | 必选 \| P0 \| 功能用例          |
| 测试设备     | 1.设备，2.串口线，3.PC          |
| 测试拓扑结构 | 一个设备串口连接PC              |
| 测试预置条件 | 设备联网                        |
| 测试步骤     | 设备订阅topic A，并保持在线状态 |
| 预期结果     | 设备订阅topic A成功             |
| 备注         |                                 |

1.  设备认证通过并连接至MQTT服务器

2.  web页面向该设备topic A发布消息

3.  设备取消订阅topicA，并保持在线状态

4.  web页面向该设备topic A发布消息

5.  步骤2执行后，设备接收到topic A的消息，消息内容与页面发布的消息内容相同

6.  步骤4执行后，设备接收不到topic A的消息

7.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备心跳

| 测试用例编号 | AOS-3-21                                 |
|--------------|------------------------------------------|
| 测试用例     | 设备心跳                                 |
| 测试目的     | 验证设备保持在线心跳机制完备             |
| 测试属性     | 必选 \| P0 \| 功能用例                   |
| 测试设备     | 1.设备，2.串口线，3.PC                   |
| 测试拓扑结构 | 一个设备串口连接PC                       |
| 测试预置条件 | 设备联网                                 |
| 测试步骤     | 设备保持在线状态不断开连接               |
| 预期结果     | 设备以心跳为周期向MQTT服务器发送心跳包   |
| 备注         | 心跳周期为用户设置，测试前需确定心跳周期 |

1.  设备认证通过并连接至MQTT服务器

2.  观察设备端日志

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备反复认证与连接

| 测试用例编号 | AOS-3-22                     |
|--------------|------------------------------|
| 测试用例     | 设备反复认证与连接           |
| 测试目的     | 验证设备反复认证与连接稳定性 |
| 测试属性     | 必选 \| P0 \| 稳定性用例     |
| 测试设备     | 1.设备，2.串口线，3.PC       |
| 测试拓扑结构 | 一个设备串口连接PC           |
| 测试预置条件 | 设备联网                     |
| 测试步骤     | 设备认证                     |
| 预期结果     | 认证与建立连接成功率99.9%    |
| 备注         |                              |

1.  认证成功后，设备建立MQTT连接

2.  设备断开MQTT连接

3.  步骤1\~3重复1W次

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### QoS1低频消息测试

| 测试用例编号 | AOS-3-23                                |
|--------------|-----------------------------------------|
| 测试用例     | QoS1低频消息测试                        |
| 测试目的     | 验证设备低频通信稳定性                  |
| 测试属性     | 必选 \| P0 \| 稳定性用例                |
| 测试设备     | 1.设备，2.串口线，3.PC                  |
| 测试拓扑结构 | 一个设备串口连接PC                      |
| 测试预置条件 | 设备联网                                |
| 测试步骤     | 设备认证连接，并保持在线状态            |
| 预期结果     | 12小时稳定工作，无离线                  |
| 备注         | 压测工具及使用见 “AliOS Things认证指南” |

1.  设备订阅topic A，在topic A回调函数中将接收到的消息转发到topic B

2.  使用压测工具以500ms周期向topic A发送消息，并统计topic B消息数量

3.  丢包率≤0.5%

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### QoS1高频消息测试

| 测试用例编号 | AOS-3-24                                |
|--------------|-----------------------------------------|
| 测试用例     | QoS1高频消息测试                        |
| 测试目的     | 验证设备高频通信稳定性                  |
| 测试属性     | 必选 \| P0 \| 稳定性用例                |
| 测试设备     | 1.设备，2.串口线，3.PC                  |
| 测试拓扑结构 | 一个设备串口连接PC                      |
| 测试预置条件 | 设备联网                                |
| 测试步骤     | 设备认证连接，并保持在线状态            |
| 预期结果     | 12小时稳定工作，无离线                  |
| 备注         | 压测工具及使用见 “AliOS Things认证指南” |

1.  设备订阅topic A，在topic A回调函数中将接收到的消息转发到topic B

2.  使用压测工具以200ms周期向topic A发送消息，并统计topic B消息数量

3.  丢包率≤1%

4.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 长时间稳定通信

| 测试用例编号 | AOS-3-25                                |
|--------------|-----------------------------------------|
| 测试用例     | 长时间稳定通信                          |
| 测试目的     | 验证设备长时间稳定工作                  |
| 测试属性     | 必选 \| P0 \| 稳定性用例                |
| 测试设备     | 1.设备，2.串口线，3.PC                  |
| 测试拓扑结构 | 一个设备串口连接PC                      |
| 测试预置条件 | 设备联网                                |
| 测试步骤     | 设备认证连接，并保持在线状态            |
| 预期结果     | 5x24小时稳定工作                        |
| 备注         | 压测工具及使用见 “AliOS Things认证指南” |

1.  离线次数＜4次

2.  单次离线时间不超过1个心跳周期

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 大数据包稳定通信

| 测试用例编号 | AOS-3-26                         |
|--------------|----------------------------------|
| 测试用例     | 大数据包稳定通信                 |
| 测试目的     | 验证设备大数据包稳定通信         |
| 测试属性     | 必选 \| P0 \| 稳定性用例         |
| 测试设备     | 1.设备，2.串口线，3.PC           |
| 测试拓扑结构 | 一个设备串口连接PC               |
| 测试预置条件 | 设备联网                         |
| 测试步骤     | 设备认证连接，并保持在线状态     |
| 预期结果     | 1小时稳定工作                    |
| 备注         | 2000字节可以根据设备实际能力调整 |

1.  设备订阅topic A，在topic A回调函数中将接收到的消息转发到topic B

2.  使用压测工具以500ms周期向topic A发送2000字节的消息，并统计topic B消息数量

3.  丢包率≤0.5%

4.  重连次数≤1次

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 断网发现与重连

| 测试用例编号 | AOS-3-27                                 |
|--------------|------------------------------------------|
| 测试用例     | 断网发现与重连                           |
| 测试目的     | 验证设备断网发现与重连的能力             |
| 测试属性     | 必选 \| P0 \| 稳定性用例                 |
| 测试设备     | 1.设备，2.串口线，3.PC                   |
| 测试拓扑结构 | 一个设备串口连接PC                       |
| 测试预置条件 | 设备联网                                 |
| 测试步骤     | 设备认证连接，并保持在线状态（维持心跳） |
| 预期结果     | 断网后3个心跳周期内发现断网并尝试重连    |
| 备注         |                                          |

1.  待连接稳定后，断开网络

2.  断网状态维持3个心跳周期的时间后恢复网络连接

3.  1个心跳周期后观察设备在线状态

4.  网络恢复后1个心跳周期内设备重连成功

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

CoAP
----

### 设备认证

| 测试用例编号 | AOS-3-28                                                                |
|--------------|-------------------------------------------------------------------------|
| 测试用例     | 设备认证                                                                |
| 测试目的     | 验证设备认证后获取iotid与iottoken                                       |
| 测试属性     | 必选 \| P0 \| 功能用例                                                  |
| 测试设备     | 1.设备，2.串口线，3.PC                                                  |
| 测试拓扑结构 | 一个设备串口连接PC                                                      |
| 测试预置条件 | 设备联网成功                                                            |
| 测试步骤     | 设备尝试通过HTTPS认证                                                   |
| 预期结果     | 设备所支持的认证方式认证通过，拿到iotid和iottoken并且成功连接CoAP服务器 |
| 备注         | CoAP支持HTTPS认证                                                       |

1.  设备连接CoAP服务器

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异

### 设备消息上行

| 测试用例编号 | AOS-3-29                                                         |
|--------------|------------------------------------------------------------------|
| 测试用例     | 设备消息上行                                                     |
| 测试目的     | 验证设备CoAP上行消息                                             |
| 测试属性     | 必选 \| P0 \| 功能用例                                           |
| 测试设备     | 1.设备，2.串口线，3.PC                                           |
| 测试拓扑结构 | 一个设备串口连接PC                                               |
| 测试预置条件 | 设备联网成功                                                     |
| 测试步骤     | 设备向topic A发送消息                                            |
| 预期结果     | 设备发布消息成功，服务日志查询的消息内容与设备发布的消息内容相同 |
| 备注         | CoAP只支持上行                                                   |

1.  设备认证成功

2.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异

### 设备反复认证

| 测试用例编号 | AOS-3-30                 |
|--------------|--------------------------|
| 测试用例     | 设备反复认证             |
| 测试目的     | 验证设备反复认证稳定性   |
| 测试属性     | 必选 \| P0 \| 稳定性用例 |
| 测试设备     | 1.设备，2.串口线，3.PC   |
| 测试拓扑结构 | 一个设备串口连接PC       |
| 测试预置条件 | 设备联网                 |
| 测试步骤     | 设备认证                 |
| 预期结果     | 认证成功率≥99.9%         |
| 备注         |                          |

1.  设备向topic A发送消息

2.  步骤1\~2重复1W次

3.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 低频CON消息

| 测试用例编号 | AOS-3-31                 |
|--------------|--------------------------|
| 测试用例     | 低频CON消息              |
| 测试目的     | 验证设备低频通信稳定性   |
| 测试属性     | 必选 \| P0 \| 稳定性用例 |
| 测试设备     | 1.设备，2.串口线，3.PC   |
| 测试拓扑结构 | 一个设备串口连接PC       |
| 测试预置条件 | 设备联网                 |
| 测试步骤     | 设备认证通过             |
| 预期结果     | 24小时稳定工作           |
| 备注         |                          |

1.  设备以500ms为周期向topic A发送消息

2.  使用工具统计topic A消息数量

3.  丢包率≤1%

4.  重连次数≤5次

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

###  长时间稳定通信

| 测试用例编号 | AOS-3-32                     |
|--------------|------------------------------|
| 测试用例     | 长时间稳定通信               |
| 测试目的     | 验证设备CoAP大数据包稳定通信 |
| 测试属性     | 必选 \| P0 \| 稳定性用例     |
| 测试设备     | 1.设备，2.串口线，3.PC       |
| 测试拓扑结构 | 一个设备串口连接PC           |
| 测试预置条件 | 设备联网                     |
| 测试步骤     | 设备认证成功                 |
| 预期结果     | 5x24小时稳定工作             |
| 备注         |                              |

1.  设备以300s的周期向topic A发布消息

2.  使用工具统计topic A消息数量

3.  丢包率≤0.1%

4.  重连次数≤3次

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 大数据包稳定通信

| 测试用例编号 | AOS-3-33                         |
|--------------|----------------------------------|
| 测试用例     | 大数据包稳定通信                 |
| 测试目的     | 验证设备大数据包稳定通信         |
| 测试属性     | 必选 \| P0 \| 稳定性用例         |
| 测试设备     | 1.设备，2.串口线，3.PC           |
| 测试拓扑结构 | 一个设备串口连接PC               |
| 测试预置条件 | 设备联网                         |
| 测试步骤     | 设备认证成功                     |
| 预期结果     | 1小时稳定工作                    |
| 备注         | 2000字节可以根据设备实际能力调整 |

1.  设备以500ms为周期向topic A发送2000字节的消息

2.  使用工具统计topic A消息数量

3.  丢包率≤0.5%

4.  重连次数≤1次

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

设备配网业务
------------

### 一键配网模式

| 测试用例编号 | AOS-3-34                                                                                                                                                                                                                                                        |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 一键配网模式                                                                                                                                                                                                                                                    |
| 测试目的     | 验证设备是否支持一键配网模式                                                                                                                                                                                                                                    |
| 测试属性     | 必选\| P0                                                                                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC ，4.手机终端                                                                                                                                                                                                                     |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                                                                                         |
| 测试预置条件 | 手机 WiFi连接无线 AP，AP开启 DHCP server                                                                                                                                                                                                                        |
| 测试步骤     | 1. 手机打开智能 APP，选择正确的联网入口，按提示说明触发设备进入联网模式  2. APP 配置无线 SSID 与无线密码，点击搜索设备 3. 设备端确认收到 SSID 及无线密钥等信息 4. 设备连接无线 AP是否成功，连接后按操作激活设备 5. 设备复位后，重复步骤1 -4重新配网激活设备成功 |
| 预期结果     | 设备能够正确获取到 SSID 及无线密钥，且连接 AP并成功激活设备成功，设备列表在线且可以控制设备                                                                                                                                                                     |
| 备注         | 1.App下载地址：https://open.aliplus.com/download/。根据接入平台，下载安装相应的App进行测试。 2.选择“模组认证-\>v3配网_热点配网”入口。 3.一键配网是默认配网技术方案。                                                                                            |

###  一键配网模时间与成功率

| 测试用例编号 | AOS-3-35                                                                                                                                                                                                                                                                                                                                               |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 一键配网模时间与成功率                                                                                                                                                                                                                                                                                                                                 |
| 测试目的     | 联网是设备入网的基础，从一键配网激活模式联网所需时间及成功率制定量化标准，以评估设备联网用户体验度。                                                                                                                                                                                                                                                   |
| 测试属性     | 必选                                                                                                                                                                                                                                                                                                                                                   |
| 测试设备     | 1.两个终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                                                                                                                                                                         |
| 测试拓扑图   | 见附录A                                                                                                                                                                                                                                                                                                                                                |
| 测试预置条件 | 1. 按附录A网络拓扑要求部署测试环境； 2. 手机WiFi连接无线AP，AP开启DHCP server。                                                                                                                                                                                                                                                                        |
| 测试步骤     | 1. 设备上电后进入配网模式； 2. 打开APP，添加设备-\>“分类查找”中查找对应的类别-\>“设备类别”查找相应的设备入口，按提示操作激活设备； 3. 激活设备后APP显示设备在线，并且可以控制设备。 4. 设备复位后，重复步骤1，2，3，重新激活设备成功。 5. 采不同主流品牌手机10款以上，重复步骤1，2，3，4，每款手机执行配网10次，记录每次测试激活时间，及激活成功次数。 |
| 预期结果     | 标准： 1. 每款手机配网成功率：≥90% 2.耗时： 优秀：耗时≤15秒 合格：15秒\<耗时≤30秒 不合格：耗时\>30秒                                                                                                                                                                                                                                                   |
| 备注         | 主流品牌：华为，荣耀，苹果，OPPO,小米，魅族，三星，VIVO等                                                                                                                                                                                                                                                                                              |

### 设备联网-手机热点配网模式

| 测试用例编号 | AOS-3-36                                                                                                                                                                                                                                                                                                     |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 设备联网-手机热点配网模式                                                                                                                                                                                                                                                                                    |
| 测试目的     | 验证模组是否支持手机热点配网模式。                                                                                                                                                                                                                                                                           |
| 测试属性     | 必选\| P0                                                                                                                                                                                                                                                                                                    |
| 测试设备     | 1.终端设备，2.非阿里智能无线路由器，3.PC，4.手机终端带运营商数据网络                                                                                                                                                                                                                                         |
| 测试拓扑图   | 见附录A                                                                                                                                                                                                                                                                                                      |
| 测试预置条件 | 按附录A网络拓扑要求部署测试环境； 手机WiFi连接无线AP，AP开启DHCP server。                                                                                                                                                                                                                                    |
| 测试步骤     | 设备上电后进入配网模式； 打开APP，添加设备-\>“分类查找”中查找对应的类别-\>“设备类别”查找相应的设备入口，输入错误错误的wifi密码造成一次配网失败； 在配网失败页面选择热点配网模式，按照app提示信息开始走热点配网流程 激活设备后APP显示设备在线，并且可以控制设备。 设备复位后，重复步骤1 - 4重新激活设备成功。 |
| 预期结果     | 联网激活设备成功。                                                                                                                                                                                                                                                                                           |
| 备注         | 此用例适合于Alink embed模组认证，见附录C说明。                                                                                                                                                                                                                                                               |

###  手机热点配网时间和成功率

| 测试用例编号 | AOS-3-37                                                                                                                                                                                        |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 手机热点配网时间和成功率                                                                                                                                                                        |
| 测试目的     | 联网是设备入网的基础，从联网所需时间与成功率制定量化标准，以评估设备联网用户体验度。                                                                                                            |
| 测试属性     | 必选\| P1                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.非阿里智能无线路由器，3.PC，4.手机终端带运营商数据网络                                                                                                                            |
| 测试拓扑图   | 见附录A                                                                                                                                                                                         |
| 测试预置条件 | 按附录A网络拓扑要求部署测试环境； 手机WiFi连接无线AP，AP开启DHCP server。                                                                                                                       |
| 测试步骤     | 选择模组认证〉热点配网入口〉输入错误的wifi密码配网。待配网失败跳转到配网失败页面后选择热点配网模式按照提示信息开始走热点配网流程 重复步骤1，各执行100次，记录每次测试激活时间，及激活成功次数。 |
| 预期结果     | 成功率：≥95% 激活时间标准： 优秀：耗时≤25秒 合格：25秒\<耗时≤35秒 不合格：耗时\>35秒                                                                                                            |
| 备注         | 此用例适合于Alink embed模组认证，见附录C说明。                                                                                                                                                  |

###  零配发现模式

| 测试用例编号 | AOS-3-38                                                                                                                                                        |
|--------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 零配发现模式                                                                                                                                                    |
| 测试目的     | 联网是设备入网的基础，从一键联网所需时间制定量化标准，以评估设备联网用户体验度                                                                                  |
| 测试属性     | 必选\| P1                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                      |
| 测试拓扑结构 | 见附录A                                                                                                                                                         |
| 测试预置条件 | 手机 WiFi连接无线 AP，AP开启 DHCP server                                                                                                                        |
| 测试步骤     | 1. 触发设备进入一键联网模式  2. 在 APP 上选择正确入口进行联网操作 3. 记录每次(100次，10个不同手机终端，每个测试 10次)联网成功(不统计失败)的时间，并计算平均时间 |
| 预期结果     | 步骤3：参考标准：优秀：耗时≤20秒；合格：20秒\<耗时≤30秒；不合格：耗时\>30秒                                                                                     |
| 备注         | 联网耗时是指 APP 开始搜索设备到设备添加成功的时间                                                                                                               |

### 零配发现联网时间与成功率

| 测试用例编号 | AOS-3-39                                                                                                                                                                                                                                                                                                                   |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 零配发现联网时间与成功率                                                                                                                                                                                                                                                                                                   |
| 测试目的     | 联网是设备入网的基础，从零配发现联网所需时间制定量化标准，以评估设备联网用户体验度。                                                                                                                                                                                                                                       |
| 测试属性     | 见备注说明                                                                                                                                                                                                                                                                                                                 |
| 测试设备     | 1.2个终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                                                                                                                                              |
| 测试拓扑图   | 见附录A                                                                                                                                                                                                                                                                                                                    |
| 测试预置条件 | 3. 按附录A网络拓扑要求部署测试环境； 4. 手机WiFi连接无线AP，AP开启DHCP server。                                                                                                                                                                                                                                            |
| 测试步骤     | 1. 设备A上电后进入配网模式，APP配网绑定设备A成功； 2. 设备B上电启动成功； 3. 打开APP-\>添加设备，在“待添加设备”列表中，应该能够发现设备B； 4. 点击“添加”设备B，按提示进行操作，可成功上线激活设备B； 5. 对设备B复位解绑，使之重新进入零配模式； 6. 重复步骤1，2，3，4，5，执行10次，记录每次测试激活时间，及激活成功次数。 |
| 测试用例编号 | 标准： 1. 成功率：≥90% 2.耗时： 优秀：≤15秒 合格：15秒\<耗时≤30秒 不合格：耗时\>30秒                                                                                                                                                                                                                                       |
| 备注         | 如果软件支持零配特性，为必选。                                                                                                                                                                                                                                                                                             |

### 更改上行 AP配置重新联网

| 测试用例编号 | AOS-3-40                                                                                                                        |
|--------------|---------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 更改上行 AP配置重新联网                                                                                                         |
| 测试目的     | 从用户角度使用上，更改上行AP配置验证重新联网是否成功                                                                            |
| 测试属性     | 必选\| P1                                                                                                                       |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                      |
| 测试拓扑结构 | 见附录A                                                                                                                         |
| 测试预置条件 | 手机 WiFi连接无线 AP，AP开启 DHCP server                                                                                        |
| 测试步骤     | 1. 触发设备进入一键联网模式，配网成功 2. 登录 AP，更改 AP名称及 SSID，保存生效 3. 重新触发设备进入联网模式，APP添加设备是否成功 |
| 预期结果     | 步骤3：更改 AP配置后，重新添加设备仍然可以成功                                                                                  |
| 备注         |                                                                                                                                 |

### 智能路由器联网

| 测试用例编号 | AOS-3-41                                                                                                                                                                                                                                                                                                   |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 智能路由器联网                                                                                                                                                                                                                                                                                             |
| 测试目的     | 验证设备能否支持智能路由器联网                                                                                                                                                                                                                                                                             |
| 测试属性     | 必选\| P0                                                                                                                                                                                                                                                                                                  |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC ，4.手机终端                                                                                                                                                                                                                                                                |
| 测试拓扑结构 | 见附录A，其中无线路由器需替换成智能路由器                                                                                                                                                                                                                                                                  |
| 测试预置条件 | 1. 无线路由器须为智能路由器 ，推荐智能 路由器型号有：                                                                                                                                                                                                                                                      |
|              | BLINK : BL -WR4000 WR4000 ，BL -WR361WR361WR361                                                                                                                                                                                                                                                            |
|              | 蚂蚁邦： ANTBANG A3 A3S                                                                                                                                                                                                                                                                                    |
|              | 睿因： WN521N2A ，                                                                                                                                                                                                                                                                                         |
|              | 高科： Q363 等 2. 手机 WiFi 连接无线 AP ，AP 开启 DHCP server                                                                                                                                                                                                                                              |
| 测试步骤     | 1. 手机连接智能路由器的 wifi 网络 -\>打开小智 app -\>选择添加设备-\>app 会显示“发现智能路由器” -\>选择绑定智能路由器  2. 手机打开智能 APP ， 选择正确的联网入口APP 会自动进入智 能路由器联网模式；按提示说明触发设备进入联网模式 3. 直接点击搜索设备 即可完成联网绑定操作后，查看设备连接无线 AP是否成功。 |
| 预期结果     | 设备通过路由器联网成功                                                                                                                                                                                                                                                                                     |
| 备注         |                                                                                                                                                                                                                                                                                                            |

### DHCP获取 IP耗时

| 测试用例编号 | AOS-3-42                                                                                                                                                                                             |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | DHCP获取 IP耗时                                                                                                                                                                                      |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从 DHCP 第一次获取IP 耗时角度给出标准                                                                                                                    |
| 测试属性     | 必选\| P0                                                                                                                                                                                            |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                           |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                              |
| 测试预置条件 | 1.手机 WiFi连接无线 AP，AP开启 DHCP server                                                                                                                                                           |
| 测试步骤     | 1. 触发设备进入联网模式 2. 在 APP 上选择正确入口进行联网操作 3. 联网成功后，设备console 查看获取 IP 地址(从发送 DHCP Discover 到 DHCP ACK获取到 IP)所需时间 4. 通过 PC，是否可以 ping通设备的 IP地址 |
| 预期结果     | 步骤4：从 DHCP第一次获取IP耗时角度给出标准 参考标准：优秀：耗时≤2秒； 合格：2秒＜耗时≤4秒； 不合格：耗时\>4秒；                                                                                      |
| 备注         |                                                                                                                                                                                                      |

### DHCP 获取 IP 成功率

| 测试用例编号 | AOS-3-43                                                                                                                                                                                                       |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | DHCP 获取 IP 成功率                                                                                                                                                                                            |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从 DHCP 获取 IP 成 功率角度给出标准                                                                                                                                |
| 测试属性     | 必选\| P1                                                                                                                                                                                                      |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                                     |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                                        |
| 测试预置条件 | 手机 WiFi连接无线 AP，AP开启 DHCP server PC 连接无线 AP                                                                                                                                                        |
| 测试步骤     | 1. 触发设备进入联网模式 2. 在 APP 上选择正确入口进行联网操作 3. 联网成功后，设备console查看设备获取 IP地址是否成功，PC端ping 设备 IP地址确认连通性 4. 重复执行步骤 1，2，3，共测试 10次，计算获取 IP地址成功率 |
| 预期结果     | 步骤4：通过标准：成功率=100%                                                                                                                                                                                   |
| 备注         |                                                                                                                                                                                                                |

### DHCP 失败重试间隔

| 测试用例编号 | AOS-3-44                                                                                                                                                                               |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | DHCP 失败重试间隔                                                                                                                                                                      |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从 DHCP 失败重试间隔角度给出标准                                                                                                           |
| 测试属性     | 必选\| P1                                                                                                                                                                              |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                             |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                |
| 测试预置条件 | 1.手机 WiFi连接无线 AP，AP开启 DHCP server 2. PC连接无线 AP，捕获数据包进行分析，如 OmniPeek                                                                                           |
| 测试步骤     | 1. 触发设备进入联网模式 2. 在上行无线路由器上关闭 DHCP server 功能，APP 上选择正确入口进行联网操作 3. 等待 10分钟，停止抓包，分析抓包 DHCPdiscover行为，查看 DHCP discover失败重试时间 |
| 预期结果     | 步骤3：建议失败请求重试间隔≤1分钟                                                                                                                                                      |
| 备注         |                                                                                                                                                                                        |

### 联网Log 查看支持

| 测试用例编号 | AOS-3-45                                                                                                                                                                      |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 联网Log 查看支持                                                                                                                                                              |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从是否支持联网 Log 查看角度给出标准。                                                                                             |
| 测试属性     | 必选\| P2                                                                                                                                                                     |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                    |
| 测试拓扑结构 | 见附录A                                                                                                                                                                       |
| 测试预置条件 | 1.手机 WiFi连接无线 AP，AP开启 DHCP server 2. PC连接无线 AP                                                                                                                   |
| 测试步骤     | 1. 扫描 SSID 及信道信息 log 2. 设备监听并打印收到完整数据信息 log，包含 SSID 与密码 3. WiFi连接 AP过程及结果 log 4. 获取 ip地址过程及结果 log 5. 设备连接云端，注册，登录 log |
| 预期结果     | 步骤1\~5：支持联网查看 Log                                                                                                                                                    |
| 备注         |                                                                                                                                                                               |

### 无线功能特性兼容性

| 测试用例编号 | AOS-3-46                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 无线功能特性兼容性                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从无线功能特性兼 容性角度给出标准。                                                                                                                                                                                                                                                                                                                                                          |
| 测试属性     | 必选\| P1                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                                                                                                                                                                                                                                                               |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 测试预置条件 | 1.手机 WiFi连接无线 AP，AP开启 DHCP server                                                                                                                                                                                                                                                                                                                                                                                               |
| 测试步骤     | 1. 设置隐藏 SSID，纯中文 SSID(GBK/UTF-8编码)，中英混合 SSID(如果支持)，SSID 中间含空格下划线中划线，SSID 头尾空格等进行联网 2. 设置信道为 1，6，13信道下，进行联网 3. 设 置 模 式 为 IEEE 802.11bgn/IEEE 802.11n only/IEEE 802.11ac/IEEE 802.11bg ,进行联网 4. 设置频宽为 20MHZ，40MHZ,进行联网 5.OPEN,WPA-PSK(TKIP),WPA-PSK(AES),WPA2-PSK(TKIP),WPA2-PSK（AES)模式下进行联网 6. 测试手机建议选择 iphone6+，华为 MATE7等双天线高速率手机 |
| 预期结果     | 步骤1\~6：所有配置无线功能项，都能成功联网接入                                                                                                                                                                                                                                                                                                                                                                                           |
| 备注         | 测试结果记录到《AOS兼容性测试报告模板.xlsx》                                                                                                                                                                                                                                                                                                                                                                                             |

### 主流 AP 兼容性

| 测试用例编号 | AOS-3-47                                                                                                                                                                                                                       |
|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 主流 AP 兼容性                                                                                                                                                                                                                 |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从与主流 AP 的兼容性角度给出标准。                                                                                                                                                 |
| 测试属性     | 必选\| P1                                                                                                                                                                                                                      |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                                                     |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                                                        |
| 测试预置条件 | 手机 WiFi连接无线 AP，AP开启 DHCP server 路由器建议使用默认无线功能配置                                                                                                                                                        |
| 测试步骤     | 测试与“B.1 主流 AP 列表”中的兼容性： 1. 触发设备进入一键联网模式 2. 在 APP 上选择正确入口进行联网操作 3. 查看联网是否成功 4. 触发设备进入 SoftAP联网模式，重复步骤 2，3，查看联网是否成功                                      |
| 预期结果     | 优秀：“主流 AP列表”中主流品牌覆盖 100%，单个品牌覆盖型号数至少一个以上 合格：“主流 AP 列表”中主流品牌覆盖 75%以上，单个品牌覆盖型号数至少一个以上 不合格：“主流 AP 列表”中主流品牌覆盖 75%以下，单个品牌覆盖型号数至少一个以上 |
| 备注         | 测试结果记录到《AOS兼容性测试报告模板.xlsx》                                                                                                                                                                                   |

### 主流手机兼容性

| 测试用例编号 | AOS-3-48                                                                                                                                                                                                                        |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 主流手机兼容性                                                                                                                                                                                                                  |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从与主流手机的兼 容性角度给出标准。                                                                                                                                                 |
| 测试属性     | 必选\| P1                                                                                                                                                                                                                       |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                                                      |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                                                         |
| 测试预置条件 | 1.手机 WiFi连接无线 AP，AP开启 DHCP server                                                                                                                                                                                      |
| 测试步骤     | 测试与“B.2 主流手机列表”中的兼容性，手机 OS 版本测试覆盖；1. 陪测无线路由器，选择 MIMO 多天线无线路由器，如 TL-WR886N 2. 无线路由器设置IEEE 802.11bgn模式，20/40MHZ频宽，加密设置为 WPA-PSK/WPA2-PSK MIXED                      |
| 预期结果     | 优秀：“主流手机列表”中主流品牌覆盖 100%，单个品牌覆盖机型数至少一个以上 合格：“主流手机列表”中主流品牌覆盖 75%以上，单个品牌覆盖机型数至少一个以上 不合格：“主流手机列表”中主流品牌覆盖 75%以下，单个品牌覆盖机型数至少一个以上 |
| 备注         | 测试结果记录到《AOS兼容性测试报告模板.xlsx》                                                                                                                                                                                    |

### 主流手机操作系统兼容性

| 测试用例编号 | AOS-3-49                                                                                                                                                                                                   |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 主流手机操作系统兼容性                                                                                                                                                                                     |
| 测试目的     | 联网是设备入网的基础，为确保设备的联网能力，从与主流手机操作 系统的兼容性角度给出标准。                                                                                                                    |
| 测试属性     | 必选\| P1                                                                                                                                                                                                  |
| 测试设备     | 1.终端设备，2.无线路由器，3.PC，4.手机终端                                                                                                                                                                 |
| 测试拓扑结构 | 见附录A                                                                                                                                                                                                    |
| 测试预置条件 | 1.手机 WiFi连接无线 AP，AP开启 DHCP server                                                                                                                                                                 |
| 测试步骤     | 测试与“B.2 主流手机列表”中的兼容性，手机 OS 版本测试覆盖；1. 陪测无线路由器，选择 MIMO 多天线无线路由器，如 TL-WR886N 2. 无线路由器设置IEEE 802.11bgn模式，20/40MHZ频宽，加密设置为 WPA-PSK/WPA2-PSK MIXED |
| 预期结果     | 手机操作系统全部兼容                                                                                                                                                                                       |
| 备注         |                                                                                                                                                                                                            |

AliOS Things FOTA测试
=====================

FOTA
----

### 设备正常升级流程

| 测试用例编号 | AOS-4-1                                |
|--------------|----------------------------------------|
| 测试用例     | 设备正常升级流程                       |
| 测试目的     | 验证设备能否正常升级                   |
| 测试属性     | 必选 \| P0 \| 功能用例                 |
| 测试设备     | 1.设备，2.串口线，3.PC                 |
| 测试拓扑结构 | 设备通过串口连接PC                     |
| 测试预置条件 | 设备联网                               |
| 测试步骤     | 设备登录并保持在线状态                 |
| 预期结果     | 设备接收升级指令并在升级成功后设备重启 |
| 备注         |                                        |

1.  制作高版本固件

2.  APP触发升级动作

3.  等待设备升级完成重启

4.  升级完成后的版本为制作的升级包版本

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 下载固件被中断

| 测试用例编号 | AOS-4-2                                      |
|--------------|----------------------------------------------|
| 测试用例     | 下载固件被中断                               |
| 测试目的     | 验证设备下载固件的过程被中断后设备不进行升级 |
| 测试属性     | 必选 \| P0 \| 稳定性用例                     |
| 测试设备     | 1.设备，2.串口线，3.PC                       |
| 测试拓扑结构 | 设备通过串口连接PC                           |
| 测试预置条件 | 设备联网                                     |
| 测试步骤     | 设备登录并保持在线状态                       |
| 预期结果     | 设备接收升级指令后下载高版本固件             |
| 备注         |                                              |

1.  制作高版本固件

2.  APP触发升级动作

3.  下载固件过程中断开网络连接

4.  网络断开后升级失败，系统重启后正常运行，版本号不变

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 升级过程关闭电源

| 测试用例编号 | AOS-4-3                          |
|--------------|----------------------------------|
| 测试用例     | 升级过程关闭电源                 |
| 测试目的     | 验证设备过程关闭电源中断升级     |
| 测试属性     | 必选 \| P0 \| 稳定性用例         |
| 测试设备     | 1.设备，2.串口线，3.PC           |
| 测试拓扑结构 | 设备通过串口连接PC               |
| 测试预置条件 | 设备联网                         |
| 测试步骤     | 设备登录并保持在线状态           |
| 预期结果     | 设备接收升级指令后下载高版本固件 |
| 备注         |                                  |

1.  制作高版本固件

2.  APP触发升级动作

3.  下载固件完成后，在擦写flash升级过程设备断电

4.  设备断电重启后正常运行，版本号不变

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 设备反复升级稳定性

| 测试用例编号 | AOS-4-4                  |
|--------------|--------------------------|
| 测试用例     | 设备反复升级稳定性       |
| 测试目的     | 验证设备反复升级稳定性   |
| 测试属性     | 必选 \| P0 \| 稳定性用例 |
| 测试设备     | 1.设备，2.串口线，3.PC   |
| 测试拓扑结构 | 设备通过串口连接PC       |
| 测试预置条件 | 设备联网                 |
| 测试步骤     | 设备登录并保持在线状态   |
| 预期结果     | 设备升级成功率≥99%       |
| 备注         |                          |

1.  制作高版本固件

2.  运行自动化脚本，定时触发升级

3.  设备升级成功后本地烧录旧版本固件以便再次升级

4.  持续运行12小时

5.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

AliOS Things 安全测试
=====================

TLS
---

### 设备数据通信使用TLS

| 测试用例编号 | AOS-5-1                                       |
|--------------|-----------------------------------------------|
| 测试用例     | 设备数据通信使用TLS                           |
| 测试目的     | 验证设备数据通信中是否使用TLS                 |
| 测试属性     | 必选 \| P0 \| 安全功能用例                    |
| 测试设备     | 1.设备，2.串口线，3.PC                        |
| 测试拓扑结构 | 设备与PC处于同一个无线/有线网络环境           |
| 测试预置条件 | 1. 设备联网 2. PC安装WireShark软件            |
| 测试步骤     | 打开WireShark软件，并开始监听局域网的数据包； |
| 预期结果     | WireShark中能检测到设备端与云端TLS握手过程；  |
| 备注         |                                               |

1.  设备上电，并与云端通信；

2.  设备端与云端的通信数据包均为TLS数据包；

ID2
---

### 设备硬件安全能力

| 测试用例编号 | AOS-5-2                                                         |
|--------------|-----------------------------------------------------------------|
| 测试用例     | 设备硬件安全能力                                                |
| 测试目的     | 验证设备是否具有硬件安全能力                                    |
| 测试属性     | 必选 \| P0 \| 安全功能用例                                      |
| 测试设备     | 1.设备                                                          |
| 测试拓扑结构 | NA                                                              |
| 测试预置条件 | NA                                                              |
| 测试步骤     | 检查设备的datasheet；                                           |
| 预期结果     | 设备带有SE或者带有TrustZone或者使用Secure MCU或者无硬件安全能力 |
| 备注         |                                                                 |

### 使用ID2完成设备认证（挑战字方式）

| 测试用例编号 | AOS-5-3                                                                                                                                         |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 使用ID2完成设备认证（挑战字方式）                                                                                                               |
| 测试目的     | 验证设备能正常使用ID2完成设备认证（挑战字方式）                                                                                                 |
| 测试属性     | 必选 \| P0 \| 安全功能用例                                                                                                                      |
| 测试设备     | 1.设备，2.串口线，3.PC                                                                                                                          |
| 测试拓扑结构 | 设备通过串口连接PC；                                                                                                                            |
| 测试预置条件 | PC端运行SP测试程序，可以响应设备端获取挑战字请求，从ID2服务端获取挑战字，并返回给设备端；从设备端获取ID2和认证码，发送给ID2服务端完成设备认证； |
| 测试步骤     | 设备端调用tfs_get_ID2获取ID2；                                                                                                                  |
| 预期结果     | 获取ID2成功；                                                                                                                                   |
| 备注         |                                                                                                                                                 |

1.  设备与PC处于同一个无线/有线网络环境

2.  设备上电开机后空闲的RAM空间 \> 1024 Bytes

3.  设备端调用获取挑战字程序获取挑战字C；

4.  设备端使用挑战字C调用tfs_id2_get_challenge_auth_code获取设备的认证码；

5.  设备端将ID2和认证码发送给SP测试程序，SP测试程序ID2和认证码发送给ID2服务器；

6.  获取挑战字C成功；

7.  获取设备认证码成功；

8.  SP认证设备程序显示认证成功；

9.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 使用ID2完成设备认证（时间戳方式）

| 测试用例编号 | AOS-5-4                                                                        |
|--------------|--------------------------------------------------------------------------------|
| 测试用例     | 使用ID2完成设备认证（时间戳方式）                                              |
| 测试目的     | 验证设备能正常使用ID2完成设备认证（时间戳方式）                                |
| 测试属性     | 必选 \| P0 \| 安全功能用例                                                     |
| 测试设备     | 1.设备，2.串口线，3.PC                                                         |
| 测试拓扑结构 | 设备通过串口连接PC；                                                           |
| 测试预置条件 | PC端运行SP测试程序，可以从设备端获取ID2和认证码，发送给ID2服务端完成设备认证； |
| 测试步骤     | 设备端调用tfs_get_ID2获取ID2；                                                 |
| 预期结果     | 获取ID2成功；                                                                  |
| 备注         |                                                                                |

1.  设备与PC处于同一个无线/有线网络环境；

2.  设备上电开机后空闲的RAM空间 \> 1024 Bytes

3.  设备端获取当前时间戳T；

4.  设备端使用时间戳T调用tfs_id2_get_timestamp_auth_code获取设备的认证码；

5.  设备端将ID2和认证码发送给SP测试程序，SP测试程序ID2和认证码发送给ID2服务器；

6.  获取时间戳T成功；

7.  获取设备认证码成功；

8.  SP认证设备程序显示认证成功；

9.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 使用ID2从服务端获取关键数据（挑战字方式）

| 测试用例编号 | AOS-5-5                                                                                                                                                                             |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 使用ID2从服务端获取关键数据（挑战字方式）                                                                                                                                           |
| 测试目的     | 验证设备能正常使用ID2从服务端获取关键数据（挑战字方式）                                                                                                                             |
| 测试属性     | 必选 \| P0 \| 安全功能用例                                                                                                                                                          |
| 测试设备     | 1.设备，2.串口线，3.PC                                                                                                                                                              |
| 测试拓扑结构 | 设备通过串口连接PC；                                                                                                                                                                |
| 测试预置条件 | PC端运行SP测试程序，可以响应设备端获取挑战字请求，从ID2服务端获取挑战字，并返回给设备端；生成关键数据，从设备端获取ID2和认证码，发送给ID2服务端获取加密后的关键数据并发送给设备端； |
| 测试步骤     | 设备端调用tfs_get_ID2获取ID2；                                                                                                                                                      |
| 预期结果     | 获取ID2成功；                                                                                                                                                                       |
| 备注         |                                                                                                                                                                                     |

1.  设备与PC处于同一个无线/有线网络环境；

2.  设备上电开机后空闲的RAM空间 \> 1024 Bytes

3.  设备端调用获取挑战字程序获取挑战字C；

4.  设备端使用挑战字C调用tfs_id2_get_challenge_auth_code获取设备的认证码；

5.  设备端将ID2和认证码发送给SP测试程序，SP测试程序生成关键数据，并将ID2、认证码及关键数据发送给ID2服务器获取加密后的关键数据；

6.  设备端从SP测试程序获取关键数据及加密后的关键数据；

7.  设备端调用tfs_id2_decrypt获取关键数据；

8.  获取挑战字C成功；

9.  获取设备认证码成功；

10. 解密后的关键数据与从SP测试程序获取的关键数据相同；

11. 系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

### 使用ID2从服务端获取关键数据（时间戳方式）

| 测试用例编号 | AOS-5-6                                                                                                            |
|--------------|--------------------------------------------------------------------------------------------------------------------|
| 测试用例     | 使用ID2从服务端获取关键数据（时间戳方式）                                                                          |
| 测试目的     | 验证设备能正常使用ID2从服务端获取关键数据（时间戳方式）                                                            |
| 测试属性     | 必选 \| P0 \| 安全功能用例                                                                                         |
| 测试设备     | 1.设备，2.串口线，3.PC                                                                                             |
| 测试拓扑结构 | 设备通过串口连接PC；                                                                                               |
| 测试预置条件 | PC端运行SP测试程序，可以生成关键数据，从设备端获取ID2和认证码，发送给ID2服务端获取加密后的关键数据并发送给设备端； |
| 测试步骤     | 设备端调用tfs_get_ID2获取ID2；                                                                                     |
| 预期结果     | 获取ID2成功；                                                                                                      |
| 备注         |                                                                                                                    |

1.  设备与PC处于同一个无线/有线网络环境；

2.  设备上电开机后空闲的RAM空间 \> 1024 Bytes

3.  设备端获取当前时间戳T；

4.  设备端使用时间戳T调用tfs_id2_get_timestamp_auth_code获取设备的认证码；

5.  设备端将ID2和认证码发送给SP测试程序，SP测试程序生成关键数据，并将ID2、认证码及关键数据发送给ID2服务器获取加密后的关键数据；

6.  设备端从SP测试程序获取关键数据及加密后的关键数据；

7.  设备端调用tfs_id2_decrypt获取关键数据；

8.  获取时间戳T成功；

9.  获取设备认证码成功；

10. 解密后的关键数据与从SP测试程序获取的关键数据相同；

11. 系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常

秘钥安全存储
------------

### 设备应用key安全存储及安全使用

| 测试用例编号 | AOS-5-7                                 |
|--------------|-----------------------------------------|
| 测试用例     | 设备应用key安全存储及安全使用           |
| 测试目的     | 验证设备是否能安全存储应用key并安全使用 |
| 测试属性     | 必选 \| P0 \| 安全功能用例              |
| 测试设备     | 1.设备，2.串口线，3.PC                  |
| 测试拓扑结构 | 设备通过串口连接PC                      |
| 测试预置条件 | NA                                      |
| 测试步骤     | 生成一个随机数K和名称A；                |
| 预期结果     | 获取Sign2成功；                         |
| 备注         |                                         |

1.  调用KM接口km_sec_store存储A，K；

2.  生成随机字符串S；

3.  使用K签名S得到Sign1；

4.  使用A调用KM签名接口km_sign签名S得到Sign2；

5.  Sign1与Sign2相同；

6.  系统无crash，fail，error，assert，abort，内存泄漏，阻塞等异常；

安全启动
--------

### 设备安全启动

| 测试用例编号 | AOS-5-8                                                                                  |
|--------------|------------------------------------------------------------------------------------------|
| 测试用例     | 设备安全启动                                                                             |
| 测试目的     | 验证设备是否具有安全启动能力                                                             |
| 测试属性     | 可选 \| P0 \| 安全功能用例                                                               |
| 测试设备     | 1.设备，2.串口线，3.PC                                                                   |
| 测试拓扑结构 | 设备通过串口连接PC                                                                       |
| 测试预置条件 | 1. 制作固件BIN； 3. 使用正确的私钥签名生成固件BIN1； 4. 使用错误的私钥签名生成固件BIN2； |
| 测试步骤     | 烧录固件BIN1到设备中，并重启设备；                                                       |
| 预期结果     | 烧录BIN1到设备中，设备重启成功；                                                         |
| 备注         |                                                                                          |

1.  烧录固件BIN2到设备中，并重启设备；

2.  烧录BIN2到设备中，设备重启失败；

附 录
=====

附录 A 测试拓扑图

1）硬件：DUT(物联设备)，无线AP，串口模块

2）软件：调试console

![捕获](media/3f0cce994c146bfff12c85f9204c8aa8.png)

图1 测试网络拓扑示意图

附录 B 复杂组网拓扑图

![kkkk](media/96c7e38b4ad5f7050a4ef2d27541b464.png)

附录 C Alink 协议版本说明

| 版本号    | 功能特性说明                                                                |
|-----------|-----------------------------------------------------------------------------|
| Alink1.0  | 1.设备端，app 端，云端 Alink 物联协议。 2.支持自主一键配网，SoftAP 配网技术 |
| Alink 1.1 | 1.增强设备身份安全                                                          |
| Alink 1.6 | 1.增加零配置方案 2.设备问题诊断功能                                         |

附录 D mesh测试设备与AP相对位置示意图

![](media/55de9326683288d600c9504af87f8dfe.png)
